webpackJsonp([0],[function(e,t,n){"use strict";var o=n(1),i=n(23);o.platformBrowserDynamic().bootstrapModule(i.AppModule)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=n(3),r=n(21),a=n(24),c=function(){function AppModule(){}return AppModule}();c=o([s.NgModule({imports:[r.BrowserModule],declarations:[a.AppComponent],bootstrap:[a.AppComponent]}),i("design:paramtypes",[])],c),t.AppModule=c},function(e,t,n){(function(e){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=n(3),r=n(26),a=n(27),c=n(28),p=n(30),d=n(31),h=function(){function AppComponent(t,n,o,i,s){this._updateService=t,this._lightComponent=n,this._loader=o,this._physicsService=i,this._skyboxComponent=s,this.gui={speed:0},this.loaded={level:!1,user:!1,skybox:!1},this.general={dt:0,last:0},this.keys={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1},this.state={dead:!1},this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,1280/720,1,2e5),this.renderer=new e.WebGLRenderer}return AppComponent.prototype.handleKeyDown=function(e){this.onKeyPress(e,!0)},AppComponent.prototype.handleKeyUp=function(e){this.onKeyPress(e,!1)},AppComponent.prototype.onKeyPress=function(e,t){"w"==e.key||38==e.keyCode?this.keys.UP=t:"s"==e.key||40==e.keyCode?this.keys.DOWN=t:"a"==e.key||37==e.keyCode?this.keys.LEFT=t:"d"!=e.key&&39!=e.keyCode||(this.keys.RIGHT=t)},AppComponent.prototype.ngOnInit=function(){var e=this;this.light=this._lightComponent.init(),this.pointLight=this._lightComponent.addPointLight();var t=n(32),o=n(33);this._loader.loadOBJ(t,o).then(function(t){t.name="player",e.player=t,e.handleLoaded("user")});var i=n(34),s=n(35);this._loader.loadOBJ(i,s).then(function(t){t.name="model",e.level=t,e.handleLoaded("level")}),this._skyboxComponent.init().then(function(t){t.name="skyBox",e.skyBox=t,e.handleLoaded("skybox")})},AppComponent.prototype.handleLoaded=function(e){this.loaded[e]=!0;var t=!0;for(var n in this.loaded)this.loaded[n]||(t=!1);t&&this.setup()},AppComponent.prototype.setup=function(){this.setupInitState(),this.addObjectsToScene(),this.addBoundingBoxesToScene(),this._canvas.nativeElement.appendChild(this.renderer.domElement),this._physicsService.setupGravity(this.scene,7.8),this.animate()},AppComponent.prototype.setupInitState=function(){this.skyBox.position.copy(this.camera.position),this.pointLight.position.copy(this.camera.position),this.renderer.setSize(1280,720)},AppComponent.prototype.addObjectsToScene=function(){this.scene.add(this.player),this.scene.add(this.level),this.scene.add(this.light),this.scene.add(this.pointLight),this.scene.add(this.skyBox)},AppComponent.prototype.addBoundingBoxesToScene=function(){var t=new e.BoxGeometry(2500,1,65e3),n=new e.MeshBasicMaterial({color:65280}),o=new e.Mesh(t,n);o.position.y=-100,o.name="ground",this.scene.add(o);var i=new e.BoxGeometry(14e3,1,2500),s=new e.Mesh(i,n);s.position.y=-100,s.position.x=-7e3,s.position.z=-33e3,s.name="ground",this.scene.add(s);var r=new e.BoxGeometry(2e4,1,2500),a=new e.Mesh(r,n);a.position.y=675,a.position.x=-16e3,a.position.z=-33e3,a.rotation.z=-.24,a.name="ground",this.scene.add(a);var c=new e.BoxGeometry(6e4,1,6e4),p=new e.MeshBasicMaterial;p.visible=!1;var d=new e.Mesh(c,p);d.position.y=-1e3,d.name="death",this.scene.add(d)},AppComponent.prototype.animate=function(){var e=this,t=(new Date).getTime();this.general.dt=Math.min(1,(t-this.general.last)/1e3),this.general.last=t;var n=this.render();n||requestAnimationFrame(function(){return e.animate()})},AppComponent.prototype.render=function(){this.gui.speed=this._updateService.update(this.player,this.camera,this.keys,this.general.dt);var e=this._physicsService.GravityCheck(this.player);return e?(this.state.dead=!0,!0):(this.skyBox.position.copy(this.player.position),this.renderer.render(this.scene,this.camera),!1)},AppComponent}();o([s.ViewChild("canvas"),i("design:type",s.ElementRef)],h.prototype,"_canvas",void 0),o([s.HostListener("document:keydown",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],h.prototype,"handleKeyDown",null),o([s.HostListener("document:keyup",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],h.prototype,"handleKeyUp",null),h=o([s.Component({selector:"app",template:n(36),providers:[r.UpdateService,a.LightComponent,c.SkyboxComponent,p.LoaderService,d.PhysicsService]}),i("design:paramtypes",[r.UpdateService,a.LightComponent,p.LoaderService,d.PhysicsService,c.SkyboxComponent])],h),t.AppComponent=h}).call(t,n(25))},,function(e,t){"use strict";var n=function(){function UpdateService(){this.acceleration=0,this.generalCarSpeedMultiplier=1e3,this.direction={X:0,Z:0,Y:0}}return UpdateService.prototype.init=function(){},UpdateService.prototype.update=function(e,t,n,o){var i=o*this.generalCarSpeedMultiplier;return this.direction={X:0,Z:0,Y:0},this.acceleration>0?this.acceleration-=.0012:this.acceleration+=.0012,n.UP&&this.acceleration<4&&(this.acceleration<0?(e.rotateX(.004),this.acceleration+=.03):this.acceleration+=.02),n.DOWN&&this.acceleration>-1.4&&(this.acceleration>0?this.acceleration-=.03:this.acceleration-=.015),n.LEFT&&e.rotateY(.02),n.RIGHT&&e.rotateY(-.02),t.quaternion.slerp(e.quaternion,.1),Math.cos(e.rotation.z)>-1?this.direction.Z=i*this.acceleration*Math.cos(e.rotation.y):this.direction.Z=i*this.acceleration*-Math.cos(e.rotation.y),this.direction.X=i*this.acceleration*Math.sin(e.rotation.y),e.position.z-=this.direction.Z,e.position.x-=this.direction.X,e.position.y-=this.direction.Y,t.position.z-=this.direction.Z,t.position.x-=this.direction.X,t.position.y-=this.direction.Y,t.position.y=e.position.y+200,this.acceleration},UpdateService}();t.UpdateService=n},function(e,t,n){(function(e){"use strict";var n=function(){function LightComponent(){this.color=4210752,this.whiteColor=16777215}return LightComponent.prototype.init=function(){return new e.AmbientLight(this.whiteColor,1)},LightComponent.prototype.addPointLight=function(){return new e.DirectionalLight(this.color,1)},LightComponent}();t.LightComponent=n}).call(t,n(25))},function(e,t,n){(function(e){"use strict";var o=function(){function SkyboxComponent(){}return SkyboxComponent.prototype.init=function(){var t=new e.SphereGeometry(1e4,25,25),o=new e.TextureLoader;return new Promise(function(i,s){o.load(n(29),function(n){var o=new e.MeshPhongMaterial({map:n}),s=new e.Mesh(t,o);s.material.side=e.BackSide,i(s)})})},SkyboxComponent}();t.SkyboxComponent=o}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg"},function(e,t,n){(function(e){"use strict";var n=function(){function LoaderService(){}return LoaderService.prototype.loadOBJ=function(t,n){var o=new e.LoadingManager;o.onProgress=function(e,t,n){console.log(e,t,n)};var i=new e.OBJLoader(o),s=(new e.TextureLoader).load(n);return s.wrapS=s.wrapT=e.RepeatWrapping,s.repeat.set(2,2),new Promise(function(n,o){i.load(t,function(t){t.traverse(function(t){t instanceof e.Mesh&&(t.material.map=s)}),n(t)})})},LoaderService}();t.LoaderService=n}).call(t,n(25))},function(e,t,n){(function(e){"use strict";var n=function(){function PhysicsService(){this.groundList=[],this.gravity=7.8}return PhysicsService.prototype.setupGravity=function(t,n){this.gravity=n;var o,i;for(var s in t.children)console.log("checking"),"death"==t.children[s].name&&(i=t.children[s],this.deathBB=(new e.Box3).setFromObject(i)),"ground"==t.children[s].name&&(console.log("added ground"),o=t.children[s],this.groundList.push((new e.Box3).setFromObject(o)))},PhysicsService.prototype.GravityCheck=function(t){var n=this,o=(new e.Box3).setFromObject(t),i=!1;return console.log("playerx"),console.log(o.min.x),console.log("playerz"),console.log(o.min.z),this.groundList.forEach(function(e,s){console.log(s),console.log("groundminx:"),console.log(e.min.x),console.log("groundminz:"),console.log(e.min.z),console.log("groundmaxx:"),console.log(e.max.x),console.log("groundmaxz:"),console.log(e.max.z),o.min.y>e.max.y&&(t.position.y-=n.gravity),o.min.x<e.min.x&&(t.position.y-=n.gravity),o.max.x>e.max.x&&(t.position.y-=n.gravity),o.min.y<n.deathBB.max.y&&(i=!0)}),i},PhysicsService}();t.PhysicsService=n}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/bike_lennart.9613cd5bf1cf98d990a09a14d63987b4.obj"},function(e,t,n){e.exports=n.p+"assets/tron.587552ce4be37cfd05ac08b4142849dd.png"},function(e,t,n){e.exports=n.p+"assets/level_lennart.f6c5e941514ad165ace7ed2a865e1046.obj"},function(e,t,n){e.exports=n.p+"assets/road.93905e756f18ec7cef67d3cc4f3fabd9.jpg"},function(e,t){e.exports='<div #canvas class="main">\n    <div class="gui">\n        <progress class="speed-progress" max="400" [value]="gui.speed * 100"></progress>\n        <i class="speed">{{(gui.speed * 100).toFixed(0)}} km/h</i>\n        <h2 [hidden]="!state.dead">YOU DIEDEDEDED</h2>\n    </div>\n</div>'}]);
//# sourceMappingURL=app.c3730744853d22031583.js.map