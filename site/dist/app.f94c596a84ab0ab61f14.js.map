{"version":3,"sources":["webpack:///app.f94c596a84ab0ab61f14.js","webpack:///./src/main.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/app.component.ts","webpack:///./src/app/services/update.service.ts","webpack:///./src/app/light/light.component.ts","webpack:///./src/app/skybox/skybox.component.ts","webpack:///./assets/textures/skySphere_2.jpg","webpack:///./src/app/services/loader.service.ts","webpack:///./src/app/services/physics.service.ts","webpack:///./assets/objects/bike_lennart.obj","webpack:///./assets/textures/tron.png","webpack:///./assets/objects/level_lennart.obj","webpack:///./assets/textures/road.jpg","webpack:///./src/app/app.component.html"],"names":["webpackJsonp","module","exports","__webpack_require__","platform_browser_dynamic_1","app_module_1","platformBrowserDynamic","bootstrapModule","AppModule","__decorate","this","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__metadata","k","v","metadata","core_1","platform_browser_1","app_component_1","NgModule","imports","BrowserModule","declarations","AppComponent","bootstrap","THREE","update_service_1","light_component_1","skybox_component_1","loader_service_1","physics_service_1","_updateService","_lightComponent","_loader","_physicsService","_skyboxComponent","gui","speed","loaded","level","user","skybox","general","dt","last","keys","UP","DOWN","LEFT","RIGHT","state","dead","scene","Scene","camera","PerspectiveCamera","renderer","WebGLRenderer","prototype","handleKeyDown","event","onKeyPress","handleKeyUp","down","keyCode","ngOnInit","_this","light","init","pointLight","addPointLight","player","playerText","loadOBJ","then","res","name","handleLoaded","levelText","skyBox","loadType","ready","x","setup","setupInitState","addObjectsToScene","addBoundingBoxesToScene","_canvas","nativeElement","appendChild","domElement","setupGravity","animate","position","copy","setSize","add","geometry","BoxGeometry","material","MeshBasicMaterial","color","cube","Mesh","y","geometry3","cube3","z","geometry4","cube4","rotation","geometry2","material2","visible","cube2","now","Date","getTime","Math","min","death","render","requestAnimationFrame","update","GravityCheck","ViewChild","ElementRef","HostListener","Function","KeyboardEvent","Component","selector","template","providers","UpdateService","LightComponent","SkyboxComponent","LoaderService","PhysicsService","call","acceleration","generalCarSpeedMultiplier","direction","X","Z","Y","car","step","rotateX","rotateY","quaternion","slerp","cos","sin","whiteColor","AmbientLight","DirectionalLight","skyGeo","SphereGeometry","loader","TextureLoader","Promise","resolve","reject","load","texture","MeshPhongMaterial","map","sky","side","BackSide","p","path","textureFile","manager","LoadingManager","onProgress","item","total","console","log","OBJLoader","wrapS","wrapT","RepeatWrapping","repeat","set","object","traverse","child","groundList","gravity","ground","children","deathBB","Box3","setFromObject","push","playerBB","forEach","groundBB","idx","max"],"mappings":"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","file":"app.f94c596a84ab0ab61f14.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar platform_browser_dynamic_1 = __webpack_require__(1);\r\n\tvar app_module_1 = __webpack_require__(23);\r\n\tplatform_browser_dynamic_1.platformBrowserDynamic().bootstrapModule(app_module_1.AppModule);\r\n\n\n/***/ },\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n\t};\r\n\tvar __metadata = (this && this.__metadata) || function (k, v) {\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n\t};\r\n\tvar core_1 = __webpack_require__(3);\r\n\tvar platform_browser_1 = __webpack_require__(21);\r\n\tvar app_component_1 = __webpack_require__(24);\r\n\tvar AppModule = (function () {\r\n\t    function AppModule() {\r\n\t    }\r\n\t    return AppModule;\r\n\t}());\r\n\tAppModule = __decorate([\r\n\t    core_1.NgModule({\r\n\t        imports: [\r\n\t            platform_browser_1.BrowserModule\r\n\t        ],\r\n\t        declarations: [\r\n\t            app_component_1.AppComponent\r\n\t        ],\r\n\t        bootstrap: [app_component_1.AppComponent]\r\n\t    }),\r\n\t    __metadata(\"design:paramtypes\", [])\r\n\t], AppModule);\r\n\texports.AppModule = AppModule;\r\n\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(THREE) {\"use strict\";\r\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n\t};\r\n\tvar __metadata = (this && this.__metadata) || function (k, v) {\r\n\t    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\r\n\t};\r\n\tvar core_1 = __webpack_require__(3);\r\n\tvar update_service_1 = __webpack_require__(26);\r\n\tvar light_component_1 = __webpack_require__(27);\r\n\tvar skybox_component_1 = __webpack_require__(28);\r\n\tvar loader_service_1 = __webpack_require__(30);\r\n\tvar physics_service_1 = __webpack_require__(31);\r\n\tvar AppComponent = (function () {\r\n\t    function AppComponent(_updateService, _lightComponent, _loader, _physicsService, _skyboxComponent) {\r\n\t        this._updateService = _updateService;\r\n\t        this._lightComponent = _lightComponent;\r\n\t        this._loader = _loader;\r\n\t        this._physicsService = _physicsService;\r\n\t        this._skyboxComponent = _skyboxComponent;\r\n\t        this.gui = {\r\n\t            speed: 0\r\n\t        };\r\n\t        this.loaded = {\r\n\t            level: false,\r\n\t            user: false,\r\n\t            skybox: false,\r\n\t        };\r\n\t        this.general = {\r\n\t            dt: 0,\r\n\t            last: 0,\r\n\t        };\r\n\t        this.keys = {\r\n\t            UP: false,\r\n\t            DOWN: false,\r\n\t            LEFT: false,\r\n\t            RIGHT: false\r\n\t        };\r\n\t        this.state = {\r\n\t            dead: false\r\n\t        };\r\n\t        this.scene = new THREE.Scene();\r\n\t        this.camera = new THREE.PerspectiveCamera(75, 1280 / 720, 1, 200000);\r\n\t        this.renderer = new THREE.WebGLRenderer();\r\n\t    }\r\n\t    //***********************\r\n\t    //setup key handlers\r\n\t    //***********************\r\n\t    AppComponent.prototype.handleKeyDown = function (event) {\r\n\t        this.onKeyPress(event, true);\r\n\t    };\r\n\t    AppComponent.prototype.handleKeyUp = function (event) {\r\n\t        this.onKeyPress(event, false);\r\n\t    };\r\n\t    AppComponent.prototype.onKeyPress = function (event, down) {\r\n\t        if (event.key == 'w' || event.keyCode == 38) {\r\n\t            this.keys.UP = down;\r\n\t        }\r\n\t        else if (event.key == 's' || event.keyCode == 40) {\r\n\t            this.keys.DOWN = down;\r\n\t        }\r\n\t        else if (event.key == 'a' || event.keyCode == 37) {\r\n\t            this.keys.LEFT = down;\r\n\t        }\r\n\t        else if (event.key == 'd' || event.keyCode == 39) {\r\n\t            this.keys.RIGHT = down;\r\n\t        }\r\n\t    };\r\n\t    //***********************\r\n\t    //on component load\r\n\t    //***********************\r\n\t    AppComponent.prototype.ngOnInit = function () {\r\n\t        var _this = this;\r\n\t        this.light = this._lightComponent.init();\r\n\t        this.pointLight = this._lightComponent.addPointLight();\r\n\t        var player = __webpack_require__(32);\r\n\t        var playerText = __webpack_require__(33);\r\n\t        this._loader.loadOBJ(player, playerText).then(function (res) {\r\n\t            res.name = \"player\";\r\n\t            _this.player = res;\r\n\t            _this.handleLoaded(\"user\");\r\n\t        });\r\n\t        var level = __webpack_require__(34);\r\n\t        var levelText = __webpack_require__(35);\r\n\t        this._loader.loadOBJ(level, levelText).then(function (res) {\r\n\t            res.name = \"model\";\r\n\t            _this.level = res;\r\n\t            _this.handleLoaded(\"level\");\r\n\t        });\r\n\t        this._skyboxComponent.init().then(function (res) {\r\n\t            res.name = \"skyBox\";\r\n\t            _this.skyBox = res;\r\n\t            _this.handleLoaded(\"skybox\");\r\n\t        });\r\n\t    };\r\n\t    //handles async loading on components\r\n\t    AppComponent.prototype.handleLoaded = function (loadType) {\r\n\t        this.loaded[loadType] = true;\r\n\t        var ready = true;\r\n\t        for (var x in this.loaded) {\r\n\t            if (!this.loaded[x])\r\n\t                ready = false;\r\n\t        }\r\n\t        if (ready) {\r\n\t            this.setup();\r\n\t        }\r\n\t    };\r\n\t    //***********************\r\n\t    //setup\r\n\t    //***********************\r\n\t    AppComponent.prototype.setup = function () {\r\n\t        this.setupInitState();\r\n\t        this.addObjectsToScene();\r\n\t        this.addBoundingBoxesToScene();\r\n\t        this._canvas.nativeElement.appendChild(this.renderer.domElement);\r\n\t        this._physicsService.setupGravity(this.scene, 7.8);\r\n\t        this.animate();\r\n\t    };\r\n\t    AppComponent.prototype.setupInitState = function () {\r\n\t        this.skyBox.position.copy(this.camera.position);\r\n\t        this.pointLight.position.copy(this.camera.position);\r\n\t        this.renderer.setSize(1280, 720);\r\n\t    };\r\n\t    AppComponent.prototype.addObjectsToScene = function () {\r\n\t        this.scene.add(this.player);\r\n\t        this.scene.add(this.level);\r\n\t        this.scene.add(this.light);\r\n\t        this.scene.add(this.pointLight);\r\n\t        this.scene.add(this.skyBox);\r\n\t    };\r\n\t    AppComponent.prototype.addBoundingBoxesToScene = function () {\r\n\t        var geometry = new THREE.BoxGeometry(2500, 1, 65000);\r\n\t        var material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });\r\n\t        var cube = new THREE.Mesh(geometry, material);\r\n\t        cube.position.y = -100;\r\n\t        cube.name = \"ground\";\r\n\t        this.scene.add(cube);\r\n\t        var geometry3 = new THREE.BoxGeometry(14000, 1, 2500);\r\n\t        var cube3 = new THREE.Mesh(geometry3, material);\r\n\t        cube3.position.y = -100;\r\n\t        cube3.position.x = -7000;\r\n\t        cube3.position.z = -33000;\r\n\t        cube3.name = \"ground\";\r\n\t        this.scene.add(cube3);\r\n\t        var geometry4 = new THREE.BoxGeometry(20000, 1, 2500);\r\n\t        var cube4 = new THREE.Mesh(geometry4, material);\r\n\t        cube4.position.y = 675;\r\n\t        cube4.position.x = -16000;\r\n\t        cube4.position.z = -33000;\r\n\t        cube4.rotation.z = -0.24;\r\n\t        cube4.name = \"ground\";\r\n\t        this.scene.add(cube4);\r\n\t        var geometry2 = new THREE.BoxGeometry(60000, 1, 60000);\r\n\t        var material2 = new THREE.MeshBasicMaterial();\r\n\t        material2.visible = false;\r\n\t        var cube2 = new THREE.Mesh(geometry2, material2);\r\n\t        cube2.position.y = -1000;\r\n\t        cube2.name = \"death\";\r\n\t        this.scene.add(cube2);\r\n\t    };\r\n\t    //***********************\r\n\t    //animations\r\n\t    //***********************\r\n\t    AppComponent.prototype.animate = function () {\r\n\t        var _this = this;\r\n\t        var now = new Date().getTime();\r\n\t        this.general.dt = Math.min(1, (now - this.general.last) / 1000);\r\n\t        this.general.last = now;\r\n\t        var death = this.render();\r\n\t        if (!death) {\r\n\t            requestAnimationFrame(function () { return _this.animate(); });\r\n\t        }\r\n\t    };\r\n\t    AppComponent.prototype.render = function () {\r\n\t        this.gui.speed = this._updateService.update(this.player, this.camera, this.keys, this.general.dt);\r\n\t        var death = this._physicsService.GravityCheck(this.player);\r\n\t        if (death) {\r\n\t            this.state.dead = true;\r\n\t            return true;\r\n\t        }\r\n\t        //keep skybox around bike\r\n\t        this.skyBox.position.copy(this.player.position);\r\n\t        this.renderer.render(this.scene, this.camera);\r\n\t        return false;\r\n\t    };\r\n\t    return AppComponent;\r\n\t}());\r\n\t__decorate([\r\n\t    core_1.ViewChild(\"canvas\"),\r\n\t    __metadata(\"design:type\", core_1.ElementRef)\r\n\t], AppComponent.prototype, \"_canvas\", void 0);\r\n\t__decorate([\r\n\t    core_1.HostListener('document:keydown', ['$event']),\r\n\t    __metadata(\"design:type\", Function),\r\n\t    __metadata(\"design:paramtypes\", [KeyboardEvent]),\r\n\t    __metadata(\"design:returntype\", void 0)\r\n\t], AppComponent.prototype, \"handleKeyDown\", null);\r\n\t__decorate([\r\n\t    core_1.HostListener('document:keyup', ['$event']),\r\n\t    __metadata(\"design:type\", Function),\r\n\t    __metadata(\"design:paramtypes\", [KeyboardEvent]),\r\n\t    __metadata(\"design:returntype\", void 0)\r\n\t], AppComponent.prototype, \"handleKeyUp\", null);\r\n\tAppComponent = __decorate([\r\n\t    core_1.Component({\r\n\t        selector: 'app',\r\n\t        template: __webpack_require__(36),\r\n\t        providers: [update_service_1.UpdateService, light_component_1.LightComponent, skybox_component_1.SkyboxComponent, loader_service_1.LoaderService, physics_service_1.PhysicsService]\r\n\t    }),\r\n\t    __metadata(\"design:paramtypes\", [update_service_1.UpdateService,\r\n\t        light_component_1.LightComponent,\r\n\t        loader_service_1.LoaderService,\r\n\t        physics_service_1.PhysicsService,\r\n\t        skybox_component_1.SkyboxComponent])\r\n\t], AppComponent);\r\n\texports.AppComponent = AppComponent;\r\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(25)))\n\n/***/ },\n/* 25 */,\n/* 26 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar UpdateService = (function () {\r\n\t    function UpdateService() {\r\n\t        this.acceleration = 0;\r\n\t        this.generalCarSpeedMultiplier = 1000;\r\n\t        this.direction = {\r\n\t            X: 0,\r\n\t            Z: 0,\r\n\t            Y: 0,\r\n\t        };\r\n\t    }\r\n\t    UpdateService.prototype.init = function () {\r\n\t    };\r\n\t    UpdateService.prototype.update = function (car, camera, keys, dt) {\r\n\t        var step = dt * this.generalCarSpeedMultiplier;\r\n\t        this.direction = {\r\n\t            X: 0,\r\n\t            Z: 0,\r\n\t            Y: 0,\r\n\t        };\r\n\t        if (this.acceleration > 0) {\r\n\t            this.acceleration -= 0.0012;\r\n\t        }\r\n\t        else {\r\n\t            this.acceleration += 0.0012;\r\n\t        }\r\n\t        if (keys.UP) {\r\n\t            if (this.acceleration < 4) {\r\n\t                if (this.acceleration < 0) {\r\n\t                    car.rotateX(0.004);\r\n\t                    this.acceleration += 0.03;\r\n\t                }\r\n\t                else {\r\n\t                    this.acceleration += 0.02;\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        if (keys.DOWN) {\r\n\t            if (this.acceleration > -1.4) {\r\n\t                if (this.acceleration > 0) {\r\n\t                    this.acceleration -= 0.03;\r\n\t                }\r\n\t                else {\r\n\t                    this.acceleration -= 0.015;\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        if (keys.LEFT) {\r\n\t            car.rotateY(0.02);\r\n\t        }\r\n\t        if (keys.RIGHT) {\r\n\t            car.rotateY(-0.02);\r\n\t        }\r\n\t        camera.quaternion.slerp(car.quaternion, 0.1);\r\n\t        if (Math.cos(car.rotation.z) > -1) {\r\n\t            this.direction.Z = step * this.acceleration * Math.cos(car.rotation.y);\r\n\t        }\r\n\t        else {\r\n\t            this.direction.Z = step * this.acceleration * -Math.cos(car.rotation.y);\r\n\t        }\r\n\t        this.direction.X = step * this.acceleration * Math.sin(car.rotation.y);\r\n\t        car.position.z -= this.direction.Z;\r\n\t        car.position.x -= this.direction.X;\r\n\t        car.position.y -= this.direction.Y;\r\n\t        camera.position.z -= this.direction.Z;\r\n\t        camera.position.x -= this.direction.X;\r\n\t        camera.position.y -= this.direction.Y;\r\n\t        camera.position.y = car.position.y + 200;\r\n\t        return this.acceleration;\r\n\t    };\r\n\t    return UpdateService;\r\n\t}());\r\n\texports.UpdateService = UpdateService;\r\n\t/*\r\n\t moves the camera and the car in a 3D space.\r\n\t Z is forward\r\n\t X is left/right.\r\n\t The car rotates and gives the offsetY to the car.\r\n\t\r\n\t Rotate X - up/down\r\n\t Rotate Y - Left/Right\r\n\t Rotate Z = turn screen\r\n\t */ \r\n\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(THREE) {\"use strict\";\r\n\tvar LightComponent = (function () {\r\n\t    function LightComponent() {\r\n\t        this.color = 0x404040;\r\n\t        this.whiteColor = 0xffffff;\r\n\t    }\r\n\t    LightComponent.prototype.init = function () {\r\n\t        return new THREE.AmbientLight(this.whiteColor, 1);\r\n\t    };\r\n\t    LightComponent.prototype.addPointLight = function () {\r\n\t        return new THREE.DirectionalLight(this.color, 1);\r\n\t    };\r\n\t    return LightComponent;\r\n\t}());\r\n\texports.LightComponent = LightComponent;\r\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(25)))\n\n/***/ },\n/* 28 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(THREE) {\"use strict\";\r\n\tvar SkyboxComponent = (function () {\r\n\t    function SkyboxComponent() {\r\n\t    }\r\n\t    SkyboxComponent.prototype.init = function () {\r\n\t        var skyGeo = new THREE.SphereGeometry(10000, 25, 25);\r\n\t        var loader = new THREE.TextureLoader();\r\n\t        return new Promise(function (resolve, reject) {\r\n\t            loader.load(__webpack_require__(29), function (texture) {\r\n\t                var material = new THREE.MeshPhongMaterial({\r\n\t                    map: texture,\r\n\t                });\r\n\t                var sky = new THREE.Mesh(skyGeo, material);\r\n\t                sky.material.side = THREE.BackSide;\r\n\t                resolve(sky);\r\n\t            });\r\n\t        });\r\n\t    };\r\n\t    return SkyboxComponent;\r\n\t}());\r\n\texports.SkyboxComponent = SkyboxComponent;\r\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(25)))\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg\";\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(THREE) {\"use strict\";\r\n\tvar LoaderService = (function () {\r\n\t    function LoaderService() {\r\n\t    }\r\n\t    LoaderService.prototype.loadOBJ = function (path, textureFile) {\r\n\t        var manager = new THREE.LoadingManager();\r\n\t        manager.onProgress = function (item, loaded, total) {\r\n\t            console.log(item, loaded, total);\r\n\t        };\r\n\t        var loader = new THREE.OBJLoader(manager);\r\n\t        var texture = new THREE.TextureLoader().load(textureFile);\r\n\t        texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\r\n\t        texture.repeat.set(2, 2);\r\n\t        return new Promise(function (resolve, reject) {\r\n\t            loader.load(path, function (object) {\r\n\t                object.traverse(function (child) {\r\n\t                    if (child instanceof THREE.Mesh) {\r\n\t                        child.material.map = texture;\r\n\t                    }\r\n\t                });\r\n\t                resolve(object);\r\n\t            });\r\n\t        });\r\n\t    };\r\n\t    return LoaderService;\r\n\t}());\r\n\texports.LoaderService = LoaderService;\r\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(25)))\n\n/***/ },\n/* 31 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(THREE) {\"use strict\";\r\n\tvar PhysicsService = (function () {\r\n\t    function PhysicsService() {\r\n\t        this.groundList = [];\r\n\t        this.gravity = 7.8;\r\n\t        // makeRect(box : THREE.Box3) : THREE.Box3 {\r\n\t        //     const rect = {\r\n\t        //         a : [box.min.x, box.min.z],\r\n\t        //         b : [box.max.x - box.min.x, box.min.z]\r\n\t        //     }\r\n\t        //\r\n\t        //\r\n\t        //\r\n\t        // }\r\n\t    }\r\n\t    PhysicsService.prototype.setupGravity = function (scene, gravity) {\r\n\t        this.gravity = gravity;\r\n\t        var ground;\r\n\t        var death;\r\n\t        for (var x in scene.children) {\r\n\t            console.log('checking');\r\n\t            if (scene.children[x].name == 'death') {\r\n\t                death = scene.children[x];\r\n\t                this.deathBB = new THREE.Box3().setFromObject(death);\r\n\t            }\r\n\t            if (scene.children[x].name == 'ground') {\r\n\t                console.log('added ground');\r\n\t                ground = scene.children[x];\r\n\t                this.groundList.push(new THREE.Box3().setFromObject(ground));\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    PhysicsService.prototype.GravityCheck = function (player) {\r\n\t        var _this = this;\r\n\t        var playerBB = new THREE.Box3().setFromObject(player);\r\n\t        var death = false;\r\n\t        var falling = false;\r\n\t        console.log('playerx');\r\n\t        console.log(playerBB.min.x);\r\n\t        console.log('playerz');\r\n\t        console.log(playerBB.min.z);\r\n\t        // this.makeRect(playerBB);\r\n\t        this.groundList.forEach(function (groundBB, idx) {\r\n\t            console.log(idx);\r\n\t            console.log('groundminx:');\r\n\t            console.log(groundBB.min.x);\r\n\t            console.log('groundminz:');\r\n\t            console.log(groundBB.min.z);\r\n\t            console.log('groundmaxx:');\r\n\t            console.log(groundBB.max.x);\r\n\t            console.log('groundmaxz:');\r\n\t            console.log(groundBB.max.z);\r\n\t            // const rect = this.makeRect(groundBB);\r\n\t            // console.log(rect);\r\n\t            // if (playerBB.min.y > groundBB.max.y) {\r\n\t            //     //todo, also when under the track , keep falling\r\n\t            //     player.position.y -= this.gravity;\r\n\t            // }\r\n\t            // if (playerBB.min.x < groundBB.min.x) {\r\n\t            //     player.position.y -= this.gravity;\r\n\t            // }\r\n\t            // if (playerBB.max.x > groundBB.max.x) {\r\n\t            //     player.position.y -= this.gravity;\r\n\t            // }\r\n\t            if (playerBB.min.y < _this.deathBB.max.y) {\r\n\t                death = true;\r\n\t            }\r\n\t        });\r\n\t        return death;\r\n\t    };\r\n\t    return PhysicsService;\r\n\t}());\r\n\texports.PhysicsService = PhysicsService;\r\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(25)))\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"assets/bike_lennart.9613cd5bf1cf98d990a09a14d63987b4.obj\";\n\n/***/ },\n/* 33 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"assets/tron.587552ce4be37cfd05ac08b4142849dd.png\";\n\n/***/ },\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"assets/level_lennart.f6c5e941514ad165ace7ed2a865e1046.obj\";\n\n/***/ },\n/* 35 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"assets/road.93905e756f18ec7cef67d3cc4f3fabd9.jpg\";\n\n/***/ },\n/* 36 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div #canvas class=\\\"main\\\">\\n    <div class=\\\"gui\\\">\\n        <progress class=\\\"speed-progress\\\" max=\\\"400\\\" [value]=\\\"gui.speed * 100\\\"></progress>\\n        <i class=\\\"speed\\\">{{(gui.speed * 100).toFixed(0)}} km/h</i>\\n        <h2 [hidden]=\\\"!state.dead\\\">YOU DIEDEDEDED</h2>\\n    </div>\\n</div>\";\n\n/***/ }\n]);\n\n\n// WEBPACK FOOTER //\n// app.f94c596a84ab0ab61f14.js","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\nimport { enableProdMode } from '@angular/core';\nimport { AppModule } from './app/app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/main.ts","import { NgModule } from '@angular/core';\nimport { BrowserModule }  from '@angular/platform-browser';\nimport { AppComponent } from './app.component';\n@NgModule({\n    imports: [\n        BrowserModule\n    ],\n    declarations: [\n        AppComponent\n    ],\n    bootstrap: [ AppComponent ]\n})\nexport class AppModule { }\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/app.module.ts","import {Component, ViewChild, ElementRef, HostListener} from '@angular/core';\nimport {UpdateService} from \"./services/update.service\";\nimport {IKeyPress} from \"./interface\";\nimport {LightComponent} from \"./light/light.component\";\nimport {SkyboxComponent} from \"./skybox/skybox.component\";\nimport {LoaderService} from \"./services/loader.service\";\nimport {PhysicsService} from \"./services/physics.service\";\n\n@Component({\n    selector: 'app',\n    template: require('./app.component.html'),\n    providers : [UpdateService, LightComponent, SkyboxComponent, LoaderService, PhysicsService]\n})\nexport class AppComponent {\n    gui = {\n        speed : 0\n    };\n\n    loaded = {\n        level: false,\n        user: false,\n        skybox: false,\n    };\n    \n    general = {\n        dt : 0,\n        last : 0,\n    };\n\n    keys : IKeyPress = {\n        UP: false,\n        DOWN: false,\n        LEFT: false,\n        RIGHT: false\n    };\n\n    player : THREE.Object3D;\n    light : THREE.Light;\n    pointLight : THREE.Light;\n    skyBox : THREE.Object3D;\n    level: THREE.Object3D;\n\n    state = {\n        dead : false\n    }\n\n    scene = new THREE.Scene();\n    camera = new THREE.PerspectiveCamera(75, 1280 / 720, 1, 200000);\n    renderer = new THREE.WebGLRenderer();\n\n    @ViewChild(\"canvas\") _canvas: ElementRef;\n\n    constructor(private _updateService: UpdateService,\n                private _lightComponent: LightComponent,\n                private _loader: LoaderService,\n                private _physicsService: PhysicsService,\n                private _skyboxComponent: SkyboxComponent) {\n\n    }\n\n    //***********************\n    //setup key handlers\n    //***********************\n\n    @HostListener('document:keydown', ['$event'])\n    handleKeyDown(event: KeyboardEvent) {\n        this.onKeyPress(event, true);\n    }\n\n    @HostListener('document:keyup', ['$event'])\n    handleKeyUp(event: KeyboardEvent) {\n        this.onKeyPress(event, false);\n    }\n\n    onKeyPress(event: any, down:boolean) {\n        if (event.key == 'w' || event.keyCode == 38) {\n            this.keys.UP = down;\n        } else if (event.key == 's' || event.keyCode == 40) {\n            this.keys.DOWN = down;\n        } else if (event.key == 'a' || event.keyCode == 37) {\n            this.keys.LEFT = down;\n        } else if (event.key == 'd' || event.keyCode == 39) {\n            this.keys.RIGHT = down;\n        }\n    }\n\n    //***********************\n    //on component load\n    //***********************\n\n    ngOnInit() {\n        this.light = this._lightComponent.init();\n        this.pointLight = this._lightComponent.addPointLight();\n\n        const player = require(\"../../assets/objects/bike_lennart.obj\");\n        const playerText = require(\"../../assets/textures/tron.png\");\n        this._loader.loadOBJ(player, playerText).then(\n            (res: THREE.Object3D) => {\n                res.name = \"player\";\n                this.player = res;\n                this.handleLoaded(\"user\");\n            }\n        );\n\n        const level = require(\"../../assets/objects/level_lennart.obj\");\n        const levelText = require(\"../../assets/textures/road.jpg\");\n        this._loader.loadOBJ(level, levelText).then(\n            (res: THREE.Object3D) => {\n                res.name = \"model\";\n                this.level = res;\n                this.handleLoaded(\"level\");\n            }\n        );\n\n        this._skyboxComponent.init().then(\n            (res: THREE.Object3D) => {\n                res.name = \"skyBox\";\n                this.skyBox = res;\n                this.handleLoaded(\"skybox\");\n            }\n        );\n    }\n\n    //handles async loading on components\n    handleLoaded(loadType : string) {\n        this.loaded[loadType] = true;\n        let ready = true;\n\n        for (let x in this.loaded) {\n            if (!this.loaded[x]) ready = false;\n        }\n        if (ready) {\n            this.setup();\n        }\n    }\n\n    //***********************\n    //setup\n    //***********************\n\n    setup() {\n        this.setupInitState();\n        this.addObjectsToScene();\n        this.addBoundingBoxesToScene();\n        this._canvas.nativeElement.appendChild(this.renderer.domElement);\n        this._physicsService.setupGravity(this.scene, 7.8);\n        this.animate()\n    }\n\n    setupInitState() {\n        this.skyBox.position.copy(this.camera.position);\n        this.pointLight.position.copy(this.camera.position);\n        this.renderer.setSize(1280, 720);\n    }\n\n    addObjectsToScene() {\n        this.scene.add( this.player );\n        this.scene.add( this.level );\n        this.scene.add( this.light );\n        this.scene.add( this.pointLight );\n        this.scene.add( this.skyBox );\n    }\n\n    addBoundingBoxesToScene() {\n        const geometry = new THREE.BoxGeometry( 2500, 1, 65000 );\n        const material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );\n        const cube = new THREE.Mesh( geometry, material );\n        cube.position.y = -100;\n        cube.name = \"ground\";\n        this.scene.add( cube );\n\n        const geometry3 = new THREE.BoxGeometry( 14000, 1, 2500 );\n        const cube3 = new THREE.Mesh( geometry3, material );\n        cube3.position.y = -100;\n        cube3.position.x = -7000;\n        cube3.position.z = -33000;\n        cube3.name = \"ground\";\n        this.scene.add( cube3 );\n\n\n        const geometry4 = new THREE.BoxGeometry( 20000, 1, 2500 );\n        const cube4 = new THREE.Mesh( geometry4, material );\n        cube4.position.y = 675;\n        cube4.position.x = -16000;\n        cube4.position.z = -33000;\n        cube4.rotation.z = -0.24;\n        cube4.name = \"ground\";\n        this.scene.add( cube4 );\n\n        const geometry2 = new THREE.BoxGeometry( 60000, 1, 60000 );\n        const material2 = new THREE.MeshBasicMaterial();\n        material2.visible = false;\n        const cube2 = new THREE.Mesh( geometry2, material2 );\n        cube2.position.y = - 1000;\n        cube2.name = \"death\";\n        this.scene.add( cube2 );\n    }\n\n    //***********************\n    //animations\n    //***********************\n\n    animate() {\n        const now = new Date().getTime();\n        this.general.dt = Math.min(1, (now - this.general.last) / 1000);\n        this.general.last = now;\n        const death = this.render();\n        if (!death) {\n            requestAnimationFrame(() => this.animate());\n        }\n    }\n\n    render() {\n        this.gui.speed = this._updateService.update(this.player, this.camera, this.keys, this.general.dt);\n        const death = this._physicsService.GravityCheck(this.player);\n        if (death) {\n            this.state.dead = true;\n            return true;\n        }\n        //keep skybox around bike\n        this.skyBox.position.copy(this.player.position);\n        this.renderer.render(this.scene, this.camera);\n        return false;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/app.component.ts","import {IKeyPress} from \"../interface\";\nexport class UpdateService {\n    acceleration: number = 0;\n    generalCarSpeedMultiplier: number =  1000;\n    direction = {\n        X: 0,\n        Z: 0,\n        Y : 0,\n    };\n\n    constructor() {\n\n    }\n\n    public init() {\n    }\n\n    public update(car :any, camera :any, keys: IKeyPress, dt :number) : number {\n        const step = dt * this.generalCarSpeedMultiplier;\n        this.direction = {\n            X: 0,\n            Z: 0,\n            Y: 0,\n        };\n\n        if (this.acceleration > 0) {\n            this.acceleration -= 0.0012;\n        } else {\n            this.acceleration += 0.0012;\n        }\n        if (keys.UP) {\n            if (this.acceleration < 4) {\n                if (this.acceleration < 0) {\n                    car.rotateX(0.004);\n                    this.acceleration += 0.03;\n                } else {\n                    this.acceleration += 0.02;\n                }\n            }\n        }\n        if (keys.DOWN) {\n            if (this.acceleration > -1.4) {\n                if (this.acceleration > 0) {\n                    this.acceleration -= 0.03;\n                } else {\n                    this.acceleration -= 0.015;\n                }\n            }\n        }\n        if (keys.LEFT) {\n            car.rotateY(0.02);\n        }\n\n        if (keys.RIGHT) {\n            car.rotateY(-0.02);\n        }\n        camera.quaternion.slerp(car.quaternion, 0.1);\n        if (Math.cos(car.rotation.z) > -1) {\n            this.direction.Z = step * this.acceleration * Math.cos(car.rotation.y);\n        } else {\n            this.direction.Z = step * this.acceleration * -Math.cos(car.rotation.y);\n        }\n\n        this.direction.X = step * this.acceleration * Math.sin(car.rotation.y);\n        car.position.z -= this.direction.Z;\n        car.position.x -= this.direction.X;\n        car.position.y -= this.direction.Y;\n\n        camera.position.z -= this.direction.Z;\n        camera.position.x -= this.direction.X;\n        camera.position.y -= this.direction.Y;\n\n        camera.position.y = car.position.y + 200;\n\n        return this.acceleration;\n    }\n\n\n}\n\n/*\n moves the camera and the car in a 3D space.\n Z is forward\n X is left/right.\n The car rotates and gives the offsetY to the car.\n\n Rotate X - up/down\n Rotate Y - Left/Right\n Rotate Z = turn screen\n */\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/services/update.service.ts","export class LightComponent {\n\n    color : number = 0x404040;\n    whiteColor : number = 0xffffff;\n\n    constructor() {\n\n    }\n\n    init() {\n        return new THREE.AmbientLight( this.whiteColor, 1 );\n    }\n\n    addPointLight() {\n        return new THREE.DirectionalLight( this.color, 1 )\n}\n}\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/light/light.component.ts","import {ISkyBoxMapping} from \"../interface\";\nexport class SkyboxComponent {\n\n    init() {\n\n        const skyGeo = new THREE.SphereGeometry(10000, 25, 25);\n\n        const loader = new THREE.TextureLoader();\n        return new Promise(\n            (resolve, reject) => {\n                loader.load(require(\"../../../assets/textures/skySphere_2.jpg\"),\n                    (texture : any) => {\n                        const material = new THREE.MeshPhongMaterial({\n                            map: texture,\n                        });\n                        const sky = new THREE.Mesh(skyGeo, material);\n                        sky.material.side = THREE.BackSide;\n                        resolve(sky)\n                    });\n            }\n        )\n\n\n\n\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/skybox/skybox.component.ts","module.exports = __webpack_public_path__ + \"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/textures/skySphere_2.jpg\n// module id = 29\n// module chunks = 0","export class LoaderService {\n    constructor() {\n\n    }\n\n\n\n    loadOBJ(path : string, textureFile: string,) {\n        const manager = new THREE.LoadingManager();\n        manager.onProgress = function ( item, loaded, total ) {\n            console.log( item, loaded, total );\n        };\n        const loader = new THREE.OBJLoader( manager );\n        const texture = new THREE.TextureLoader().load(textureFile);\n        texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n        texture.repeat.set( 2, 2 );\n\n        return new Promise((resolve, reject) => {\n            loader.load(path, (object : THREE.Object3D) => {\n                object.traverse( function ( child :any ) {\n                    if ( child instanceof THREE.Mesh ) {\n                        child.material.map = texture;\n                    }\n                });\n                resolve(object);\n            });\n        });\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/services/loader.service.ts","export class PhysicsService {\n\n    groundList : THREE.Box3[] = [];\n    deathBB : THREE.Box3;\n    gravity : number = 7.8;\n\n    setupGravity(scene : THREE.Scene, gravity? : number) {\n        this.gravity = gravity;\n        let ground;\n        let death;\n        for (let x in scene.children) {\n            console.log('checking');\n            if (scene.children[x].name == 'death') {\n                death = scene.children[x];\n                this.deathBB = new THREE.Box3().setFromObject(death);\n            }\n            if (scene.children[x].name == 'ground') {\n                console.log('added ground');\n                ground = scene.children[x];\n                this.groundList.push(new THREE.Box3().setFromObject(ground))\n            }\n        }\n    }\n\n\n    GravityCheck(player : THREE.Object3D) : boolean {\n        const playerBB = new THREE.Box3().setFromObject(player);\n        let death = false;\n        let falling = false;\n        console.log('playerx')\n        console.log(playerBB.min.x);\n        console.log('playerz')\n        console.log(playerBB.min.z);\n\n        // this.makeRect(playerBB);\n        this.groundList.forEach((groundBB, idx) => {\n            console.log(idx);\n            console.log('groundminx:');\n            console.log(groundBB.min.x);\n            console.log('groundminz:');\n            console.log(groundBB.min.z);\n            console.log('groundmaxx:');\n            console.log(groundBB.max.x);\n            console.log('groundmaxz:');\n            console.log(groundBB.max.z);\n\n            // const rect = this.makeRect(groundBB);\n\n            // console.log(rect);\n\n\n\n\n            // if (playerBB.min.y > groundBB.max.y) {\n            //     //todo, also when under the track , keep falling\n            //     player.position.y -= this.gravity;\n            // }\n            // if (playerBB.min.x < groundBB.min.x) {\n            //     player.position.y -= this.gravity;\n            // }\n            // if (playerBB.max.x > groundBB.max.x) {\n            //     player.position.y -= this.gravity;\n            // }\n            if (playerBB.min.y < this.deathBB.max.y) {\n                death = true;\n            }\n        });\n        return death;\n    }\n\n    // makeRect(box : THREE.Box3) : THREE.Box3 {\n    //     const rect = {\n    //         a : [box.min.x, box.min.z],\n    //         b : [box.max.x - box.min.x, box.min.z]\n    //     }\n    //\n    //\n    //\n    // }\n}\n\n\n// WEBPACK FOOTER //\n// ./~/angular2-template-loader!./src/app/services/physics.service.ts","module.exports = __webpack_public_path__ + \"assets/bike_lennart.9613cd5bf1cf98d990a09a14d63987b4.obj\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/objects/bike_lennart.obj\n// module id = 32\n// module chunks = 0","module.exports = __webpack_public_path__ + \"assets/tron.587552ce4be37cfd05ac08b4142849dd.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/textures/tron.png\n// module id = 33\n// module chunks = 0","module.exports = __webpack_public_path__ + \"assets/level_lennart.f6c5e941514ad165ace7ed2a865e1046.obj\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/objects/level_lennart.obj\n// module id = 34\n// module chunks = 0","module.exports = __webpack_public_path__ + \"assets/road.93905e756f18ec7cef67d3cc4f3fabd9.jpg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./assets/textures/road.jpg\n// module id = 35\n// module chunks = 0","module.exports = \"<div #canvas class=\\\"main\\\">\\n    <div class=\\\"gui\\\">\\n        <progress class=\\\"speed-progress\\\" max=\\\"400\\\" [value]=\\\"gui.speed * 100\\\"></progress>\\n        <i class=\\\"speed\\\">{{(gui.speed * 100).toFixed(0)}} km/h</i>\\n        <h2 [hidden]=\\\"!state.dead\\\">YOU DIEDEDEDED</h2>\\n    </div>\\n</div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.html\n// module id = 36\n// module chunks = 0"],"sourceRoot":""}