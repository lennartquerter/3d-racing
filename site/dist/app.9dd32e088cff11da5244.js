webpackJsonp([0],{0:function(e,t,n){"use strict";var r=n(1),o=n(23);r.platformBrowserDynamic().bootstrapModule(o.AppModule)},23:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(21),a=n(24),c=n(56),p=n(538),h=n(540),l=n(543),u=n(57),f=n(59),d=n(60),y=n(61),g=n(178),m=n(63),v=n(179),b=n(66),k=n(532),S=n(533),w=[{path:"",component:p.HomeComponent},{path:"game",component:u.GameComponent},{path:"player",component:h.PlayerSelectComponent},{path:"**",component:l.PageNotFoundComponent}],x=function(){function AppModule(){}return AppModule}();x=r([i.NgModule({imports:[s.BrowserModule,a.RouterModule.forRoot(w)],declarations:[c.AppComponent,p.HomeComponent,l.PageNotFoundComponent,u.GameComponent,h.PlayerSelectComponent],providers:[d.LightService,y.SkyBoxService,f.UpdateService,g.KeyService,m.LoaderService,v.MultiplayerService,b.PhysicsService,k.AnimationService,S.PlayerService],bootstrap:[c.AppComponent]}),o("design:paramtypes",[])],x),t.AppModule=x},56:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(57),a=function(){function AppComponent(){}return AppComponent}();a=r([i.Component({selector:"app",template:n(537),providers:[s.GameComponent]}),o("design:paramtypes",[])],a),t.AppComponent=a},57:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(59),a=n(60),c=n(61),p=n(63),h=n(66),l=n(178),u=n(179),f=n(180),d=n(532),y=n(533),g=function(){function GameComponent(t,n,r,o,i,s,a,c,p){this._updateService=t,this._lightService=n,this._loader=r,this._physicsService=o,this._keyService=i,this._multiplayerService=s,this._animationService=a,this._player=c,this._skyBoxService=p,this.gui={speed:0,gravity:0,lapTime:0},this.loaded={level:!1,user:!1,skybox:!1},this.general={dt:0,last:0,frame:0},this.keys={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1},this.state={dead:!1},this.connectedPlayers=[],this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,1280/720,1,2e5),this.renderer=new e.WebGLRenderer,this._socketService=new f.WebSocketService}return GameComponent.prototype.handleKeyDown=function(e){this.keys=this._keyService.onKeyPress(e,!0)},GameComponent.prototype.handleKeyUp=function(e){this.keys=this._keyService.onKeyPress(e,!1)},GameComponent.prototype.ngOnInit=function(){var e=this;this.setupSubscriptions(),this.setupCurrentPlayer(),this._socketService.connectToGame(this.currentPlayer).then(function(t){e.connectedPlayers=t.playerList,e.connectedPlayers.length>0?(console.log("there are other players in scene"),e._multiplayerService.initializePlayers(e.scene,e.connectedPlayers).then(function(){return e.loadCurrentGame()})):e.loadCurrentGame()})},GameComponent.prototype.setupCurrentPlayer=function(){this.currentPlayer={ID:"NULL",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},name:"test2",bike:this._player.getBike(),bikeTexture:this._player.getTexture()}},GameComponent.prototype.setupSubscriptions=function(){var e=this;this.connection=this._socketService.getPlayerPositions().subscribe(function(t){console.log("get player pos"),e.connectedPlayers=t}),this.newPlayerConnect=this._socketService.getNewPlayer().subscribe(function(t){console.log("new Player Connected"),e._multiplayerService.startNewPlayer(e.scene,t)}),this.onPlayerdisconnect=this._socketService.onDisconnect().subscribe(function(t){console.log("PlayerDisconnected"),e._multiplayerService.deletePlayer(e.scene,t)}),this.animateSubscription=this._animationService.animation().subscribe(function(t){e.general=t,e.render()})},GameComponent.prototype.loadCurrentGame=function(){var e=this;this.light=this._lightService.addAmbientLight(14532543),this.pointLight=this._lightService.addPointLight(),this._loader.loadOBJ(this.currentPlayer.bike,this.currentPlayer.bikeTexture).then(function(t){t.name="player",e.player=t,e.handleLoaded("user")});var t=n(534),r=n(535);this._loader.loadOBJ(t,r).then(function(t){t.name="model",e.level=t,e.handleLoaded("level")}),this._skyBoxService.init().then(function(t){t.name="skyBox",e.skyBox=t,e.handleLoaded("skybox")})},GameComponent.prototype.handleLoaded=function(e){this.loaded[e]=!0;var t=!0;for(var n in this.loaded)this.loaded[n]||(t=!1);t&&this.setup()},GameComponent.prototype.reloadGame=function(){this.state.dead=!1,this.player.position.x=0,this.player.position.y=0,this.player.position.z=0,this.player.rotation.x=0,this.player.rotation.y=0,this.player.rotation.z=0,this.skyBox.position.copy(this.player.position),this.camera.position.copy(this.player.position),this._updateService.reset(),this.animate()},GameComponent.prototype.setup=function(){this.setupInitState(),this.addObjectsToScene(),this.addBoundingBoxesToScene(),this._canvas.nativeElement.appendChild(this.renderer.domElement),this._physicsService.setupGravity(this.scene),this.animate()},GameComponent.prototype.setupInitState=function(){this.skyBox.position.copy(this.camera.position),this.pointLight.position.copy(this.camera.position),this.renderer.setSize(1280,720)},GameComponent.prototype.addObjectsToScene=function(){this.scene.add(this.player),this.scene.add(this.level),this.scene.add(this.light),this.scene.add(this.pointLight),this.scene.add(this.skyBox)},GameComponent.prototype.addBoundingBoxesToScene=function(){var t=new e.BoxGeometry(6e4,1,6e4),n=new e.MeshBasicMaterial;n.visible=!1;var r=new e.Mesh(t,n);r.position.y=-2e3,r.name="death",this.scene.add(r)},GameComponent.prototype.animate=function(){var e=this,t=(new Date).getTime();this.general.dt=Math.min(1,(t-this.general.last)/1e3),this.general.last=t,this.render(),this.state.dead||(this.general.frame++,this.general.frame>24&&(this.general.frame=0),requestAnimationFrame(function(){return e.animate()}))},GameComponent.prototype.render=function(){var e=this;this.gui.speed=this._updateService.update(this.player,this.camera,this.keys,this.general.dt);var t=this._physicsService.GravityCheck(this.player,this.camera);t.d&&(this.state.dead=!0),this.gui.lapTime=t.lt,this.general.frame%4==0&&(this.currentPlayer.position.x=this.player.position.x,this.currentPlayer.position.y=this.player.position.y,this.currentPlayer.position.z=this.player.position.z,this.currentPlayer.rotation.x=this.player.rotation.x,this.currentPlayer.rotation.y=this.player.rotation.y,this.currentPlayer.rotation.z=this.player.rotation.z,this._socketService.sendPlayerPosition(this.currentPlayer).then(function(t){e.connectedPlayers=t,e._multiplayerService.updateOtherPlayers(e.connectedPlayers)})),this.gui.gravity=t.g,this.skyBox.position.copy(this.player.position),this.renderer.render(this.scene,this.camera)},GameComponent}();r([i.ViewChild("canvas"),o("design:type",i.ElementRef)],g.prototype,"_canvas",void 0),r([i.HostListener("document:keydown",["$event"]),o("design:type",Function),o("design:paramtypes",[KeyboardEvent]),o("design:returntype",void 0)],g.prototype,"handleKeyDown",null),r([i.HostListener("document:keyup",["$event"]),o("design:type",Function),o("design:paramtypes",[KeyboardEvent]),o("design:returntype",void 0)],g.prototype,"handleKeyUp",null),g=r([i.Component({selector:"game",template:n(536)}),o("design:paramtypes",[s.UpdateService,a.LightService,p.LoaderService,h.PhysicsService,l.KeyService,u.MultiplayerService,d.AnimationService,y.PlayerService,c.SkyBoxService])],g),t.GameComponent=g}).call(t,n(58))},59:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function UpdateService(){this.acceleration=0,this.maxSpeed=7,this.generalCarSpeedMultiplier=1e3,this.direction={X:0,Z:0,Y:0}}return UpdateService.prototype.init=function(){},UpdateService.prototype.reset=function(){this.acceleration=0},UpdateService.prototype.update=function(e,t,n,r){var o=r*this.generalCarSpeedMultiplier;return this.direction={X:0,Z:0,Y:0},this.acceleration>0?(this.acceleration-=.0012,e.rotation.x>0&&e.rotateX(-.001)):this.acceleration+=.0012,n.UP&&this.acceleration<this.maxSpeed&&(this.acceleration<0?this.acceleration+=.03:this.acceleration+=.02),n.DOWN&&this.acceleration>-1.4&&(this.acceleration>0?this.acceleration-=.03:this.acceleration-=.015),n.LEFT&&e.rotateY(.02),n.RIGHT&&e.rotateY(-.02),parseInt(Math.cos(e.rotation.z).toFixed(0))>-1?this.direction.Z=o*this.acceleration*Math.cos(e.rotation.y):this.direction.Z=o*this.acceleration*-Math.cos(e.rotation.y),this.direction.X=o*this.acceleration*Math.sin(e.rotation.y),e.position.z-=this.direction.Z,e.position.x-=this.direction.X,e.position.y-=this.direction.Y,t.position.z-=this.direction.Z,t.position.x-=this.direction.X,t.position.y-=this.direction.Y,t.quaternion.slerp(e.quaternion,.1),t.position.y=e.position.y+200,this.acceleration},UpdateService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.UpdateService=s},60:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function LightService(){this.color=4210752,this.whiteColor=14532543,this.softWhite=14532543}return LightService.prototype.addAmbientLight=function(t){return new e.AmbientLight(t,1)},LightService.prototype.addSoftAmbientLight=function(){return new e.AmbientLight(this.softWhite,1)},LightService.prototype.createSpotLight=function(t){var n=new e.DirectionalLight(t,.8);return n.castShadow=!0,n},LightService.prototype.addPointLight=function(){return new e.DirectionalLight(this.color,1)},LightService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.LightService=s}).call(t,n(58))},61:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function SkyBoxService(){}return SkyBoxService.prototype.init=function(){var t=new e.SphereGeometry(1e4,25,25),r=new e.TextureLoader;return new Promise(function(o,i){r.load(n(62),function(n){var r=new e.MeshPhongMaterial({map:n}),i=new e.Mesh(t,r);i.material.side=e.BackSide,o(i)})})},SkyBoxService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.SkyBoxService=s}).call(t,n(58))},62:function(e,t,n){e.exports=n.p+"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg"},63:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function LoaderService(){}return LoaderService.prototype.loadOBJ=function(t,r){t||(console.log("could not get url to bike, using standard bike"),t=n(64)),r||(console.log("could not get texurefile, using standard tex"),r=n(65));var o=new e.LoadingManager;o.onProgress=function(e,t,n){console.log(e,t,n)};var i=new e.OBJLoader(o),s=(new e.TextureLoader).load(r);return s.wrapS=s.wrapT=e.RepeatWrapping,s.repeat.set(2,2),new Promise(function(n,r){i.load(t,function(t){t.traverse(function(t){t instanceof e.Mesh&&(t.material.map=s)}),n(t)})})},LoaderService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.LoaderService=s}).call(t,n(58))},64:function(e,t,n){e.exports=n.p+"assets/bike_2.c7f1bf100e585ceb1e1b7b83f5d58b60.obj"},65:function(e,t,n){e.exports=n.p+"assets/tron-01.141f64773389e7d877b5bf9449984327.jpg"},66:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(67),s=n(3),a=function(){function PhysicsService(){this.groundList=[],this.collidableMeshList=[],this.rays=[new e.Vector3(0,0,1),new e.Vector3(0,0,-1),new e.Vector3(1,0,0),new e.Vector3(1,0,1),new e.Vector3(1,0,-1),new e.Vector3(-1,0,0),new e.Vector3(-1,0,1),new e.Vector3(-1,0,-1),new e.Vector3(0,1,0),new e.Vector3(0,1,1),new e.Vector3(0,1,-1),new e.Vector3(1,1,0),new e.Vector3(-1,1,0),new e.Vector3(0,-1,0),new e.Vector3(0,-1,1),new e.Vector3(0,-1,-1),new e.Vector3(-1,-1,0),new e.Vector3(1,-1,0),new e.Vector3(0,0,0)],this.caster=new e.Raycaster,this.distanceAbove=0,this.distanceBelow=0,this.fallTime=0,this.intersect=!1,this.previousOutcome=0}return PhysicsService.prototype.setupGravity=function(t){this.startTime=i();for(var n in t.children){if("model"==t.children[n].name){var r=new e.MeshBasicMaterial({color:65280});this.level=new e.Mesh(t.children[n].children[0].geometry,r),this.level.position.y=0,this.collidableMeshList.push(this.level)}"death"==t.children[n].name&&(this.deathBB=(new e.Box3).setFromObject(t.children[n]))}var o=new e.BoxGeometry(2500,2500,1),s=new e.MeshBasicMaterial({color:65280});this.startLine=new e.Mesh(o,s),this.startLine.position.z=1250},PhysicsService.prototype.GravityCheck=function(t,n){var r=(new e.Box3).setFromObject(t),o=r.min.y<this.deathBB.max.y,i=this.checkForCollision(t),s=0;return this.distanceAbove=parseFloat(this.distanceAbove.toFixed(2)),this.distanceBelow=parseFloat(this.distanceBelow.toFixed(2)),this.distanceAbove<=1?s-=.6*this.distanceAbove:this.distanceAbove>1&&(s+=.6*this.distanceAbove),this.distanceBelow<=1?s+=.2*this.distanceBelow:this.distanceBelow>1&&(s-=.2*this.distanceBelow),this.intersect||(s-=25e3/(t.position.y-this.deathBB.min.y)),this.previousOutcome-t.position.y>2?n.rotateX(-.01):this.previousOutcome-t.position.y<-2&&n.rotateX(.01),this.previousOutcome=t.position.y,s<1&&s>-1&&(s=0),t.position.y+=s,{d:o,g:s,lt:i}},PhysicsService.prototype.checkForCollision=function(e){var t,n,r,o=128;for(this.intersect=!1,n=0;n<this.rays.length;n+=1)this.caster.set(e.position,this.rays[n]),t=this.caster.intersectObjects(this.collidableMeshList),t.length>0&&t[0].distance<=o&&(8==n&&(this.intersect=!0,this.distanceAbove=t[0].distance),13==n&&(this.intersect=!0,this.distanceBelow=t[0].distance));this.caster.set(e.position,this.rays[0]),r=this.caster.intersectObject(this.startLine),r.length>0&&r[0].distance<=o&&(this.startTime=i());var s=i();return i.utc(i(s,"DD/MM/YYYY HH:mm:ss").diff(i(this.startTime,"DD/MM/YYYY HH:mm:ss"))).seconds()},PhysicsService}();a=r([s.Injectable(),o("design:paramtypes",[])],a),t.PhysicsService=a}).call(t,n(58))},178:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function KeyService(){this.keys={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1}}return KeyService.prototype.onKeyPress=function(e,t){return"w"==e.key||38==e.keyCode?this.keys.UP=t:"s"==e.key||40==e.keyCode?this.keys.DOWN=t:"a"==e.key||37==e.keyCode?this.keys.LEFT=t:"d"!=e.key&&39!=e.keyCode||(this.keys.RIGHT=t),this.keys},KeyService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.KeyService=s},179:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},s=n(63),a=n(3),c=n(3),p=function(){function MultiplayerService(e){this._loader=e,this.players={},this.loadedPlayers={}}return MultiplayerService.prototype.setLoaderObject=function(e){for(var t in e)this.loadedPlayers[e[t].ID]=!1},MultiplayerService.prototype.initializePlayers=function(e,t){var n=this;return console.log("init other players"),console.log(t),new Promise(function(r,o){var i=[];for(var s in t){var a=t[s].bike,c=t[s].bikeTexture;i.push(n._loader.loadOBJ(a,c))}Promise.all(i).then(function(o){for(var i in t)n.players[t[i].ID]=o[i],n.players[t[i].ID].position.z=t[i].position.z,n.players[t[i].ID].position.y=t[i].position.y,n.players[t[i].ID].position.x=t[i].position.x,n.players[t[i].ID].rotation.z=t[i].rotation.z,n.players[t[i].ID].rotation.y=t[i].rotation.y,n.players[t[i].ID].rotation.x=t[i].rotation.x,console.log(n.players[t[i].ID]),e.add(n.players[t[i].ID]);r(!0)})})},MultiplayerService.prototype.startNewPlayer=function(e,t){var n=this,r=t.bike,o=t.bikeTexture;this._loader.loadOBJ(r,o).then(function(r){n.players[t.ID]=r,console.log("added player"),e.add(r)})},MultiplayerService.prototype.handleLoaded=function(e){this.loadedPlayers[e]=!0;var t=!0;for(var n in this.loadedPlayers)this.loadedPlayers[n]||(t=!1);if(t)return!0},MultiplayerService.prototype.deletePlayer=function(e,t){e.remove(this.players[t]),delete this.players[t]},MultiplayerService.prototype.updateOtherPlayers=function(e){if(1!=e.length)for(var t in e)this.players[e[t].ID]&&(this.players[e[t].ID].position.z=e[t].position.z,this.players[e[t].ID].position.y=e[t].position.y,this.players[e[t].ID].position.x=e[t].position.x,this.players[e[t].ID].rotation.z=e[t].rotation.z,this.players[e[t].ID].rotation.y=e[t].rotation.y,this.players[e[t].ID].rotation.x=e[t].rotation.x)},MultiplayerService}();p=r([c.Injectable(),i(0,a.Inject(s.LoaderService)),o("design:paramtypes",[s.LoaderService])],p),t.MultiplayerService=p},180:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(181),s=n(3),a=n(479),c=function(){function WebSocketService(){this.socket=a.connect()}return WebSocketService.prototype.ngOnInit=function(){this.socket.on("connect_error",function(){console.log("Connection failed")}),this.socket.on("reconnect_failed",function(){console.log("Reconnection failed")})},WebSocketService.prototype.sendPlayerPosition=function(e){var t=this;return new Promise(function(n,r){t.socket.emit("playerPosition",e,function(e){n(e.playerList)})})},WebSocketService.prototype.getPlayerPositions=function(){var e=this,t=new i.Observable(function(t){return e.socket.on("positionUpdate",function(e){t.next(e)}),function(){e.socket.disconnect()}});return t},WebSocketService.prototype.onDisconnect=function(){var e=this,t=new i.Observable(function(t){return e.socket.on("disconnectedPlayer",function(e){console.log("socket: disconnect"),t.next(e.ID)}),function(){e.socket.disconnect()}});return t},WebSocketService.prototype.getNewPlayer=function(){var e=this,t=new i.Observable(function(t){return e.socket.on("newPlayer",function(e){t.next(e.player)}),function(){e.socket.disconnect()}});return t},WebSocketService.prototype.connectToGame=function(e){var t=this;return new Promise(function(n,r){t.socket.emit("gameConnect",e,function(e){console.log("got data from gameConnect"),n(e)})})},WebSocketService}();c=r([s.Injectable(),o("design:paramtypes",[])],c),t.WebSocketService=c},479:function(e,t,n){function lookup(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),c=o.source,p=o.id,h=o.path,l=a[p]&&h in a[p].nsps,u=t.forceNew||t["force new connection"]||!1===t.multiplex||l;return u?(s("ignoring socket cache for %s",c),n=i(c,t)):(a[p]||(s("new io instance for %s",c),a[p]=i(c,t)),n=a[p]),o.query&&!t.query?t.query=o.query:t&&"object"==typeof t.query&&(t.query=encodeQueryString(t.query)),n.socket(o.path,t)}function encodeQueryString(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}var r=n(480),o=n(485),i=n(495),s=n(482)("socket.io-client");e.exports=t=lookup;var a=t.managers={};t.protocol=o.protocol,t.connect=lookup,t.Manager=n(495),t.Socket=n(526)},480:function(e,t,n){(function(t){function url(e,n){var i=e;n=n||t.location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof n?n.protocol+"//"+e:"https://"+e),o("parse %s",e),i=r(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";var s=i.host.indexOf(":")!==-1,a=s?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+a+":"+i.port,i.href=i.protocol+"://"+a+(n&&n.port===i.port?"":":"+i.port),i}var r=n(481),o=n(482)("socket.io-client:url");e.exports=url}).call(t,function(){return this}())},481:function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");o!=-1&&i!=-1&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var s=n.exec(e||""),a={},c=14;c--;)a[r[c]]=s[c]||"";return o!=-1&&i!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},482:[808,483],483:[809,484],484:function(e,t){function parse(e){if(e=String(e),!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]),c=(t[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function fmtShort(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}function fmtLong(e){return plural(e,i,"day")||plural(e,o,"hour")||plural(e,r,"minute")||plural(e,n,"second")||e+" ms"}function plural(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var n=1e3,r=60*n,o=60*r,i=24*o,s=365.25*i;e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return parse(e);if("number"===n&&isNaN(e)===!1)return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},485:function(e,t,n){function Encoder(){}function encodeAsString(e){var n="",i=!1;return n+=e.type,t.BINARY_EVENT!=e.type&&t.BINARY_ACK!=e.type||(n+=e.attachments,n+="-"),e.nsp&&"/"!=e.nsp&&(i=!0,n+=e.nsp),null!=e.id&&(i&&(n+=",",i=!1),n+=e.id),null!=e.data&&(i&&(n+=","),n+=o.stringify(e.data)),r("encoded %j as %s",e,n),n}function encodeAsBinary(e,t){function writeEncoding(e){var n=s.deconstructPacket(e),r=encodeAsString(n.packet),o=n.buffers;o.unshift(r),t(o)}s.removeBlobs(e,writeEncoding)}function Decoder(){this.reconstructor=null}function decodeString(e){var n={},o=0;if(n.type=Number(e.charAt(0)),null==t.types[n.type])return error();if(t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type){for(var i="";"-"!=e.charAt(++o)&&(i+=e.charAt(o),o!=e.length););if(i!=Number(i)||"-"!=e.charAt(o))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"==e.charAt(o+1))for(n.nsp="";++o;){var s=e.charAt(o);if(","==s)break;if(n.nsp+=s,o==e.length)break}else n.nsp="/";var a=e.charAt(o+1);if(""!==a&&Number(a)==a){for(n.id="";++o;){var s=e.charAt(o);if(null==s||Number(s)!=s){--o;break}if(n.id+=e.charAt(o),o==e.length)break}n.id=Number(n.id)}return e.charAt(++o)&&(n=tryParse(n,e.substr(o))),r("decoded %s as %j",e,n),n}function tryParse(e,t){try{e.data=o.parse(t)}catch(e){return error()}return e}function BinaryReconstructor(e){this.reconPack=e,this.buffers=[]}function error(e){return{type:t.ERROR,data:"parser error"}}var r=n(486)("socket.io-parser"),o=n(489),i=n(491),s=n(492),a=n(494);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=Encoder,t.Decoder=Decoder,Encoder.prototype.encode=function(e,n){if(r("encoding packet %j",e),t.BINARY_EVENT==e.type||t.BINARY_ACK==e.type)encodeAsBinary(e,n);else{var o=encodeAsString(e);n([o])}},i(Decoder.prototype),Decoder.prototype.add=function(e){var n;if("string"==typeof e)n=decodeString(e),t.BINARY_EVENT==n.type||t.BINARY_ACK==n.type?(this.reconstructor=new BinaryReconstructor(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,this.emit("decoded",n))}},Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},486:function(e,t,n){function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function load(){var e;try{e=t.storage.debug}catch(e){}return e}function localstorage(){try{return window.localStorage}catch(e){}}t=e.exports=n(487),t.log=log,t.formatArgs=formatArgs,t.save=save,t.load=load,t.useColors=useColors,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(load())},487:function(e,t,n){function selectColor(){return t.colors[o++%t.colors.length]}function debug(e){function disabled(){}function enabled(){var e=enabled,n=+new Date,o=n-(r||n);e.diff=o,e.prev=r,e.curr=n,r=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var i=Array.prototype.slice.call(arguments);i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&(i=["%o"].concat(i));var s=0;i[0]=i[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;s++;var o=t.formatters[r];if("function"==typeof o){var a=i[s];n=o.call(e,a),i.splice(s,1),s--}return n}),"function"==typeof t.formatArgs&&(i=t.formatArgs.apply(e,i));var a=enabled.log||t.log||console.log.bind(console);a.apply(e,i)}disabled.enabled=!1,enabled.enabled=!0;var n=t.enabled(e)?enabled:disabled;return n.namespace=e,n}function enable(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&(e=n[o].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function disable(){t.enable("")}function enabled(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=debug,t.coerce=coerce,t.disable=disable,t.enable=enable,t.enabled=enabled,t.humanize=n(488),t.names=[],t.skips=[],t.formatters={};var r,o=0},488:function(e,t){function parse(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var a=parseFloat(t[1]),c=(t[2]||"ms").toLowerCase();switch(c){case"years":case"year":
case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a}}}}function short(e){return e>=i?Math.round(e/i)+"d":e>=o?Math.round(e/o)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}function long(e){return plural(e,i,"day")||plural(e,o,"hour")||plural(e,r,"minute")||plural(e,n,"second")||e+" ms"}function plural(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var n=1e3,r=60*n,o=60*r,i=24*o,s=365.25*i;e.exports=function(e,t){return t=t||{},"string"==typeof e?parse(e):t.long?long(e):short(e)}},489:function(e,t,n){var r;(function(e,o){(function(){function runInContext(e,t){function has(e){if(has[e]!==d)return has[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=has("json-stringify")&&has("json-parse");else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c=t.stringify,p="function"==typeof c&&m;if(p){(s=function(){return 1}).toJSON=s;try{p="0"===c(0)&&"0"===c(new n)&&'""'==c(new r)&&c(g)===d&&c(d)===d&&c()===d&&"1"===c(s)&&"[1]"==c([s])&&"[null]"==c([d])&&"null"==c(null)&&"[null,null,null]"==c([d,g,null])&&c({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===c(null,s)&&"[\n 1,\n 2\n]"==c([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==c(new i(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==c(new i(864e13))&&'"-000001-01-01T00:00:00.000Z"'==c(new i(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==c(new i(-1))}catch(e){p=!1}}o=p}if("json-parse"==e){var h=t.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){s=h(a);var l=5==s.a.length&&1===s.a[0];if(l){try{l=!h('"\t"')}catch(e){}if(l)try{l=1!==h("01")}catch(e){}if(l)try{l=1!==h("1.")}catch(e){}}}}catch(e){l=!1}o=l}}return has[e]=!!o}e||(e=c.Object()),t||(t=c.Object());var n=e.Number||c.Number,r=e.String||c.String,o=e.Object||c.Object,i=e.Date||c.Date,a=e.SyntaxError||c.SyntaxError,p=e.TypeError||c.TypeError,h=e.Math||c.Math,l=e.JSON||c.JSON;"object"==typeof l&&l&&(t.stringify=l.stringify,t.parse=l.parse);var u,f,d,y=o.prototype,g=y.toString,m=new i(-0xc782b5b800cec);try{m=m.getUTCFullYear()==-109252&&0===m.getUTCMonth()&&1===m.getUTCDate()&&10==m.getUTCHours()&&37==m.getUTCMinutes()&&6==m.getUTCSeconds()&&708==m.getUTCMilliseconds()}catch(e){}if(!has("json")){var v="[object Function]",b="[object Date]",k="[object Number]",S="[object String]",w="[object Array]",x="[object Boolean]",B=has("bug-string-char-index");if(!m)var C=h.floor,P=[0,31,59,90,120,151,181,212,243,273,304,334],_=function(e,t){return P[t]+365*(e-1970)+C((e-1969+(t=+(t>1)))/4)-C((e-1901+t)/100)+C((e-1601+t)/400)};if((u=y.hasOwnProperty)||(u=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=g?u=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,u=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,u.call(this,e)}),f=function(e,t){var n,r,o,i=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,r=new n;for(o in r)u.call(r,o)&&i++;return n=r=null,i?f=2==i?function(e,t){var n,r={},o=g.call(e)==v;for(n in e)o&&"prototype"==n||u.call(r,n)||!(r[n]=1)||!u.call(e,n)||t(n)}:function(e,t){var n,r,o=g.call(e)==v;for(n in e)o&&"prototype"==n||!u.call(e,n)||(r="constructor"===n)||t(n);(r||u.call(e,n="constructor"))&&t(n)}:(r=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(e,t){var n,o,i=g.call(e)==v,a=!i&&"function"!=typeof e.constructor&&s[typeof e.hasOwnProperty]&&e.hasOwnProperty||u;for(n in e)i&&"prototype"==n||!a.call(e,n)||t(n);for(o=r.length;n=r[--o];a.call(e,n)&&t(n));}),f(e,t)},!has("json-stringify")){var A={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},R="000000",O=function(e,t){return(R+(t||0)).slice(-e)},j="\\u00",E=function(e){for(var t='"',n=0,r=e.length,o=!B||r>10,i=o&&(B?e.split(""):e);n<r;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=A[s];break;default:if(s<32){t+=j+O(2,s.toString(16));break}t+=o?i[n]:e.charAt(n)}}return t+'"'},T=function(e,t,n,r,o,i,s){var a,c,h,l,y,m,v,B,P,A,R,j,M,L,D,N;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if(c=g.call(a),c!=b||u.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=k&&c!=S&&c!=w||u.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(_){for(y=C(a/864e5),h=C(y/365.2425)+1970-1;_(h+1,0)<=y;h++);for(l=C((y-_(h,0))/30.42);_(h,l+1)<=y;l++);y=1+y-_(h,l),m=(a%864e5+864e5)%864e5,v=C(m/36e5)%24,B=C(m/6e4)%60,P=C(m/1e3)%60,A=m%1e3}else h=a.getUTCFullYear(),l=a.getUTCMonth(),y=a.getUTCDate(),v=a.getUTCHours(),B=a.getUTCMinutes(),P=a.getUTCSeconds(),A=a.getUTCMilliseconds();a=(h<=0||h>=1e4?(h<0?"-":"+")+O(6,h<0?-h:h):O(4,h))+"-"+O(2,l+1)+"-"+O(2,y)+"T"+O(2,v)+":"+O(2,B)+":"+O(2,P)+"."+O(3,A)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if(c=g.call(a),c==x)return""+a;if(c==k)return a>-1/0&&a<1/0?""+a:"null";if(c==S)return E(""+a);if("object"==typeof a){for(L=s.length;L--;)if(s[L]===a)throw p();if(s.push(a),R=[],D=i,i+=o,c==w){for(M=0,L=a.length;M<L;M++)j=T(M,a,n,r,o,i,s),R.push(j===d?"null":j);N=R.length?o?"[\n"+i+R.join(",\n"+i)+"\n"+D+"]":"["+R.join(",")+"]":"[]"}else f(r||a,function(e){var t=T(e,a,n,r,o,i,s);t!==d&&R.push(E(e)+":"+(o?" ":"")+t)}),N=R.length?o?"{\n"+i+R.join(",\n"+i)+"\n"+D+"}":"{"+R.join(",")+"}":"{}";return s.pop(),N}};t.stringify=function(e,t,n){var r,o,i,a;if(s[typeof t]&&t)if((a=g.call(t))==v)o=t;else if(a==w){i={};for(var c,p=0,h=t.length;p<h;c=t[p++],a=g.call(c),(a==S||a==k)&&(i[c]=1));}if(n)if((a=g.call(n))==k){if((n-=n%1)>0)for(r="",n>10&&(n=10);r.length<n;r+=" ");}else a==S&&(r=n.length<=10?n:n.slice(0,10));return T("",(c={},c[""]=e,c),o,i,r,"",[])}}if(!has("json-parse")){var M,L,D=r.fromCharCode,N={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},I=function(){throw M=L=null,a()},q=function(){for(var e,t,n,r,o,i=L,s=i.length;M<s;)switch(o=i.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=B?i.charAt(M):i[M],M++,e;case 34:for(e="@",M++;M<s;)if(o=i.charCodeAt(M),o<32)I();else if(92==o)switch(o=i.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=N[o],M++;break;case 117:for(t=++M,n=M+4;M<n;M++)o=i.charCodeAt(M),o>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||I();e+=D("0x"+i.slice(t,M));break;default:I()}else{if(34==o)break;for(o=i.charCodeAt(M),t=M;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++M);e+=i.slice(t,M)}if(34==i.charCodeAt(M))return M++,e;I();default:if(t=M,45==o&&(r=!0,o=i.charCodeAt(++M)),o>=48&&o<=57){for(48==o&&(o=i.charCodeAt(M+1),o>=48&&o<=57)&&I(),r=!1;M<s&&(o=i.charCodeAt(M),o>=48&&o<=57);M++);if(46==i.charCodeAt(M)){for(n=++M;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==M&&I(),M=n}if(o=i.charCodeAt(M),101==o||69==o){for(o=i.charCodeAt(++M),43!=o&&45!=o||M++,n=M;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==M&&I(),M=n}return+i.slice(t,M)}if(r&&I(),"true"==i.slice(M,M+4))return M+=4,!0;if("false"==i.slice(M,M+5))return M+=5,!1;if("null"==i.slice(M,M+4))return M+=4,null;I()}return"$"},U=function(e){var t,n;if("$"==e&&I(),"string"==typeof e){if("@"==(B?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=q(),"]"!=e;n||(n=!0))n&&(","==e?(e=q(),"]"==e&&I()):I()),","==e&&I(),t.push(U(e));return t}if("{"==e){for(t={};e=q(),"}"!=e;n||(n=!0))n&&(","==e?(e=q(),"}"==e&&I()):I()),","!=e&&"string"==typeof e&&"@"==(B?e.charAt(0):e[0])&&":"==q()||I(),t[e.slice(1)]=U(q());return t}I()}return e},z=function(e,t,n){var r=H(e,t,n);r===d?delete e[t]:e[t]=r},H=function(e,t,n){var r,o=e[t];if("object"==typeof o&&o)if(g.call(o)==w)for(r=o.length;r--;)z(o,r,n);else f(o,function(e){z(o,e,n)});return n.call(e,t,o)};t.parse=function(e,t){var n,r;return M=0,L=""+e,n=U(q()),"$"!=q()&&I(),M=L=null,t&&g.call(t)==v?H((r={},r[""]=n,r),"",t):n}}}return t.runInContext=runInContext,t}var i=n(490),s={function:!0,object:!0},a=s[typeof t]&&t&&!t.nodeType&&t,c=s[typeof window]&&window||this,p=a&&s[typeof e]&&e&&!e.nodeType&&"object"==typeof o&&o;if(!p||p.global!==p&&p.window!==p&&p.self!==p||(c=p),a&&!i)runInContext(c,a);else{var h=c.JSON,l=c.JSON3,u=!1,f=runInContext(c,c.JSON3={noConflict:function(){return u||(u=!0,c.JSON=h,c.JSON3=l,h=l=null),f}});c.JSON={parse:f.parse,stringify:f.stringify}}i&&(r=function(){return f}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)))}).call(this)}).call(t,n(68)(e),function(){return this}())},490:function(e,t){(function(t){e.exports=t}).call(t,{})},491:function(e,t){function Emitter(e){if(e)return mixin(e)}function mixin(e){for(var t in Emitter.prototype)e[t]=Emitter.prototype[t];return e}e.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},Emitter.prototype.once=function(e,t){function on(){n.off(e,on),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},on.fn=t,this.on(e,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},Emitter.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},Emitter.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length}},492:function(e,t,n){(function(e){var r=n(493),o=n(494);t.deconstructPacket=function(e){function _deconstructPacket(e){if(!e)return e;if(o(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var i=new Array(e.length),s=0;s<e.length;s++)i[s]=_deconstructPacket(e[s]);return i}if("object"==typeof e&&!(e instanceof Date)){var i={};for(var a in e)i[a]=_deconstructPacket(e[a]);return i}return e}var t=[],n=e.data,i=e;return i.data=_deconstructPacket(n),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){function _reconstructPacket(e){if(e&&e._placeholder){var n=t[e.num];return n}if(r(e)){for(var o=0;o<e.length;o++)e[o]=_reconstructPacket(e[o]);return e}if(e&&"object"==typeof e){for(var i in e)e[i]=_reconstructPacket(e[i]);return e}return e}return e.data=_reconstructPacket(e.data),e.attachments=void 0,e},t.removeBlobs=function(t,n){function _removeBlobs(t,a,c){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){i++;var p=new FileReader;p.onload=function(){c?c[a]=this.result:s=this.result,--i||n(s)},p.readAsArrayBuffer(t)}else if(r(t))for(var h=0;h<t.length;h++)_removeBlobs(t[h],h,t);else if(t&&"object"==typeof t&&!o(t))for(var l in t)_removeBlobs(t[l],l,t)}var i=0,s=t;_removeBlobs(s),i||n(s)}}).call(t,function(){return this}())},493:function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},494:function(e,t){(function(t){function isBuf(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}e.exports=isBuf}).call(t,function(){return this}())},495:function(e,t,n){function Manager(e,t){return this instanceof Manager?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new Manager(e,t)}var r=n(496),o=n(526),i=n(527),s=n(485),a=n(529),c=n(530),p=n(482)("socket.io-client:manager"),h=n(524),l=n(531),u=Object.prototype.hasOwnProperty;e.exports=Manager,Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)u.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},Manager.prototype.updateSocketIds=function(){for(var e in this.nsps)u.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},i(Manager.prototype),Manager.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(e,t){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=a(n,"open",function(){o.onopen(),e&&e()}),s=a(n,"error",function(t){if(p("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()});if(!1!==this._timeout){var c=this._timeout;p("connect attempt will timeout after %d",c);var h=setTimeout(function(){p("connect attempt timed out after %d",c),i.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",c)},c);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(i),this.subs.push(s),this},Manager.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",c(this,"ondata"))),this.subs.push(a(e,"ping",c(this,"onping"))),this.subs.push(a(e,"pong",c(this,"onpong"))),this.subs.push(a(e,"error",c(this,"onerror"))),this.subs.push(a(e,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},Manager.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},Manager.prototype.ondata=function(e){this.decoder.add(e)},Manager.prototype.ondecoded=function(e){this.emit("packet",e)},Manager.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},Manager.prototype.socket=function(e,t){function onConnecting(){~h(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",onConnecting),n.on("connect",function(){n.id=r.engine.id}),this.autoConnect&&onConnecting()}return n},Manager.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},Manager.prototype.packet=function(e){p("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},Manager.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++){var n=this.subs.shift();n.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(p("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(p("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(p("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},Manager.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},496:function(e,t,n){e.exports=n(497)},497:function(e,t,n){e.exports=n(498),e.exports.parser=n(505)},498:function(e,t,n){(function(t){function Socket(e,n){if(!(this instanceof Socket))return new Socket(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=c(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=c(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized?null:n.rejectUnauthorized,this.forceNode=!!n.forceNode;var r="object"==typeof t&&t;r.global===r&&(n.extraHeaders&&Object.keys(n.extraHeaders).length>0&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function clone(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var r=n(499),o=n(514),i=n(518)("engine.io-client:socket"),s=n(524),a=n(505),c=n(481),p=n(525),h=n(515);e.exports=Socket,Socket.priorWebsocketSuccess=!1,o(Socket.prototype),Socket.protocol=a.protocol,Socket.Socket=Socket,Socket.Transport=n(504),Socket.transports=n(499),Socket.parser=n(505),Socket.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=clone(this.query);t.EIO=a.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return n},Socket.prototype.open=function(){var e;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},Socket.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},Socket.prototype.probe=function(e){function onTransportOpen(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;Socket.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(i("changing transport and sending upgrade packet"),cleanup(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{i('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}}))}function freezeTransport(){n||(n=!0,cleanup(),t.close(),t=null)}function onerror(n){var o=new Error("probe error: "+n);o.transport=t.name,freezeTransport(),i('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),freezeTransport())}function cleanup(){t.removeListener("open",onTransportOpen),t.removeListener("error",onerror),t.removeListener("close",onTransportClose),r.removeListener("close",onclose),r.removeListener("upgrading",onupgrade)}i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;Socket.priorWebsocketSuccess=!1,t.once("open",onTransportOpen),t.once("error",onerror),t.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),t.open()},Socket.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},Socket.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(p(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},Socket.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},Socket.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},Socket.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},Socket.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){n=n||{},n.compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},Socket.prototype.close=function(){function close(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function cleanupAndClose(){e.removeListener("upgrade",cleanupAndClose),e.removeListener("upgradeError",cleanupAndClose),close()}function waitForUpgrade(){e.once("upgrade",cleanupAndClose),e.once("upgradeError",cleanupAndClose)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()}return this},Socket.prototype.onError=function(e){i("socket error %j",e),Socket.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},Socket.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}},Socket.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},499:function(e,t,n){(function(e){function polling(t){var n,s=!1,a=!1,c=!1!==t.jsonp;if(e.location){var p="https:"===location.protocol,h=location.port;h||(h=p?443:80),s=t.hostname!==location.hostname||h!==t.port,a=t.secure!==p}if(t.xdomain=s,t.xscheme=a,n=new r(t),"open"in n&&!t.forceJSONP)return new o(t);if(!c)throw new Error("JSONP disabled");return new i(t)}var r=n(500),o=n(502),i=n(521),s=n(522);t.polling=polling,t.websocket=s}).call(t,function(){return this}())},500:function(e,t,n){(function(t){var r=n(501);e.exports=function(e){var n=e.xdomain,o=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!o&&i)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},501:function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},502:function(e,t,n){(function(t){function empty(){}function XHR(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}else this.extraHeaders=e.extraHeaders}function Request(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function unloadHandler(){for(var e in Request.requests)Request.requests.hasOwnProperty(e)&&Request.requests[e].abort()}var r=n(500),o=n(503),i=n(514),s=n(516),a=n(518)("engine.io-client:polling-xhr");e.exports=XHR,e.exports.Request=Request,s(XHR,o),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new Request(e)},XHR.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},XHR.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},i(Request.prototype),Request.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new r(e),o=this;try{a("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders){n.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}}catch(e){}if(this.supportsBinary&&(n.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),
this.hasXDR()?(n.onload=function(){o.onLoad()},n.onerror=function(){o.onError(n.responseText)}):n.onreadystatechange=function(){4===n.readyState&&(200===n.status||1223===n.status?o.onLoad():setTimeout(function(){o.onError(n.status)},0))},a("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){o.onError(e)},0)}t.document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},Request.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},Request.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,e)try{this.xhr.abort()}catch(e){}t.document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===t)e=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){for(var n=new Uint8Array(this.xhr.response),r=[],o=0,i=n.length;o<i;o++)r.push(n[o]);e=String.fromCharCode.apply(null,r)}else e=this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},Request.prototype.hasXDR=function(){return"undefined"!=typeof t.XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},Request.requestsCount=0,Request.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",unloadHandler):t.addEventListener&&t.addEventListener("beforeunload",unloadHandler,!1))}).call(t,function(){return this}())},503:function(e,t,n){function Polling(e){var t=e&&e.forceBase64;p&&!t||(this.supportsBinary=!1),r.call(this,e)}var r=n(504),o=n(515),i=n(505),s=n(516),a=n(517),c=n(518)("engine.io-client:polling");e.exports=Polling;var p=function(){var e=n(500),t=new e({xdomain:!1});return null!=t.responseType}();s(Polling,r),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(e){function pause(){c("paused"),t.readyState="paused",e()}var t=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){c("pre-pause polling complete"),--n||pause()})),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",function(){c("pre-pause writing complete"),--n||pause()}))}else pause()},Polling.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(e){var t=this;c("polling got data %s",e);var n=function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)};i.decodePayload(e,this.socket.binaryType,n),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},Polling.prototype.doClose=function(){function close(){c("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(c("transport open - closing"),close()):(c("transport not open - deferring close"),this.once("open",close))},Polling.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},Polling.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},504:function(e,t,n){function Transport(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var r=n(505),o=n(514);e.exports=Transport,o(Transport.prototype),Transport.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},Transport.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},Transport.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},Transport.prototype.onPacket=function(e){this.emit("packet",e)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},505:function(e,t,n){(function(e){function encodeBase64Object(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}function encodeArrayBuffer(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=u[e.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}function encodeBlobAsArrayBuffer(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,t.encodePacket(e,n,!0,r)},o.readAsArrayBuffer(e.data)}function encodeBlob(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return encodeBlobAsArrayBuffer(e,n,r);var o=new Uint8Array(1);o[0]=u[e.type];var i=new y([o.buffer,e.data]);return r(i)}function tryDecode(e){try{e=c.decode(e)}catch(e){return!1}return e}function map(e,t,n){for(var r=new Array(e.length),o=a(e.length,n),i=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},s=0;s<e.length;s++)i(s,e[s],o)}var r,o=n(506),i=n(507),s=n(509),a=n(510),c=n(511);e&&e.ArrayBuffer&&(r=n(512));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=p||h;t.protocol=3;var u=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=o(u),d={type:"error",data:"parser error"},y=n(513);t.encodePacket=function(t,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var i=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&i instanceof ArrayBuffer)return encodeArrayBuffer(t,n,o);if(y&&i instanceof e.Blob)return encodeBlob(t,n,o);if(i&&i.base64)return encodeBase64Object(t,o);var s=u[t.type];return void 0!==t.data&&(s+=r?c.encode(String(t.data)):String(t.data)),o(""+s)},t.encodeBase64Packet=function(n,r){var o="b"+t.packets[n.type];if(y&&n.data instanceof e.Blob){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(n.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var a=new Uint8Array(n.data),c=new Array(a.length),p=0;p<a.length;p++)c[p]=a[p];s=String.fromCharCode.apply(null,c)}return o+=e.btoa(s),r(o)},t.decodePacket=function(e,n,r){if(void 0===e)return d;if("string"==typeof e){if("b"==e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&(e=tryDecode(e),e===!1))return d;var o=e.charAt(0);return Number(o)==o&&f[o]?e.length>1?{type:f[o],data:e.substring(1)}:{type:f[o]}:d}var i=new Uint8Array(e),o=i[0],a=s(e,1);return y&&"blob"===n&&(a=new y([a])),{type:f[o],data:a}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&y&&(o=new y([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){function setLengthHeader(e){return e.length+":"+e}function encodeOne(e,r){t.encodePacket(e,!!o&&n,!0,function(e){r(null,setLengthHeader(e))})}"function"==typeof n&&(r=n,n=null);var o=i(e);return n&&o?y&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void map(e,encodeOne,function(e,t){return r(t.join(""))}):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);"function"==typeof n&&(r=n,n=null);var o;if(""==e)return r(d,0,1);for(var i,s,a="",c=0,p=e.length;c<p;c++){var h=e.charAt(c);if(":"!=h)a+=h;else{if(""==a||a!=(i=Number(a)))return r(d,0,1);if(s=e.substr(c+1,i),a!=s.length)return r(d,0,1);if(s.length){if(o=t.decodePacket(s,n,!0),d.type==o.type&&d.data==o.data)return r(d,0,1);var l=r(o,c+i,p);if(!1===l)return}c+=i,a=""}}return""!=a?r(d,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){function encodeOne(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})}return e.length?void map(e,encodeOne,function(e,t){var r=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),o=new Uint8Array(r),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}t?o[i++]=0:o[i++]=1;for(var a=n.byteLength.toString(),s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(var r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]}),n(o.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){function encodeOne(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}for(var i=e instanceof ArrayBuffer?e.byteLength:e.size,s=i.toString(),a=new Uint8Array(s.length+1),o=0;o<s.length;o++)a[o]=parseInt(s[o]);if(a[s.length]=255,y){var c=new y([t.buffer,a.buffer,e]);n(null,c)}})}map(e,encodeOne,function(e,t){return n(new y(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[],a=!1;o.byteLength>0;){for(var c=new Uint8Array(o),p=0===c[0],h="",l=1;255!=c[l];l++){if(h.length>310){a=!0;break}h+=c[l]}if(a)return r(d,0,1);o=s(o,2+h.length),h=parseInt(h);var u=s(o,0,h);if(p)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var f=new Uint8Array(u);u="";for(var l=0;l<f.length;l++)u+=String.fromCharCode(f[l])}i.push(u),o=s(o,h)}var y=i.length;i.forEach(function(e,o){r(t.decodePacket(e,n,!0),o,y)})}}).call(t,function(){return this}())},506:function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},507:function(e,t,n){(function(t){function hasBinary(e){function _hasBinary(e){if(!e)return!1;if(t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer||t.Blob&&e instanceof Blob||t.File&&e instanceof File)return!0;if(r(e)){for(var n=0;n<e.length;n++)if(_hasBinary(e[n]))return!0}else if(e&&"object"==typeof e){e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&_hasBinary(e[o]))return!0}return!1}return _hasBinary(e)}var r=n(508);e.exports=hasBinary}).call(t,function(){return this}())},508:493,509:function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},510:function(e,t){function after(e,t,n){function proxy(e,o){if(proxy.count<=0)throw new Error("after called too many times");--proxy.count,e?(r=!0,t(e),t=n):0!==proxy.count||r||t(null,o)}var r=!1;return n=n||noop,proxy.count=e,0===e?t():proxy}function noop(){}e.exports=after},511:function(e,t,n){var r;(function(e,o){!function(i){function ucs2decode(e){for(var t,n,r=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--)):r.push(t);return r}function ucs2encode(e){for(var t,n=e.length,r=-1,o="";++r<n;)t=e[r],t>65535&&(t-=65536,o+=l(t>>>10&1023|55296),t=56320|1023&t),o+=l(t);return o}function createByte(e,t){return l(e>>t&63|128)}function encodeCodePoint(e){if(0==(4294967168&e))return l(e);var t="";return 0==(4294965248&e)?t=l(e>>6&31|192):0==(4294901760&e)?(t=l(e>>12&15|224),t+=createByte(e,6)):0==(4292870144&e)&&(t=l(e>>18&7|240),t+=createByte(e,12),t+=createByte(e,6)),t+=l(63&e|128)}function wtf8encode(e){for(var t,n=ucs2decode(e),r=n.length,o=-1,i="";++o<r;)t=n[o],i+=encodeCodePoint(t);return i}function readContinuationByte(){if(h>=p)throw Error("Invalid byte index");var e=255&c[h];if(h++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function decodeSymbol(){var e,t,n,r,o;if(h>p)throw Error("Invalid byte index");if(h==p)return!1;if(e=255&c[h],h++,0==(128&e))return e;if(192==(224&e)){var t=readContinuationByte();if(o=(31&e)<<6|t,o>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=readContinuationByte(),n=readContinuationByte(),o=(15&e)<<12|t<<6|n,o>=2048)return o;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=readContinuationByte(),n=readContinuationByte(),r=readContinuationByte(),o=(15&e)<<18|t<<12|n<<6|r,o>=65536&&o<=1114111))return o;throw Error("Invalid WTF-8 detected")}function wtf8decode(e){c=ucs2decode(e),p=c.length,h=0;for(var t,n=[];(t=decodeSymbol())!==!1;)n.push(t);return ucs2encode(n)}var s="object"==typeof t&&t,a=("object"==typeof e&&e&&e.exports==s&&e,"object"==typeof o&&o);a.global!==a&&a.window!==a||(i=a);var c,p,h,l=String.fromCharCode,u={version:"1.0.0",encode:wtf8encode,decode:wtf8decode};r=function(){return u}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))}(this)}).call(t,n(68)(e),function(){return this}())},512:function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3===2?i=i.substring(0,i.length-1)+"=":o%3===1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,s,a=.75*e.length,c=e.length,p=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var h=new ArrayBuffer(a),l=new Uint8Array(h);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],l[p++]=r<<2|o>>4,l[p++]=(15&o)<<4|i>>2,l[p++]=(3&i)<<6|63&s;return h}}()},513:function(e,t){(function(t){function mapArrayBufferViews(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function BlobBuilderConstructor(e,t){t=t||{};var r=new n;mapArrayBufferViews(e);for(var o=0;o<e.length;o++)r.append(e[o]);return t.type?r.getBlob(t.type):r.getBlob()}function BlobConstructor(e,t){return mapArrayBufferViews(e),new Blob(e,t||{})}var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,r=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(e){return!1}}(),o=r&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(e){return!1}}(),i=n&&n.prototype.append&&n.prototype.getBlob;e.exports=function(){return r?o?t.Blob:BlobConstructor:i?BlobBuilderConstructor:void 0}()}).call(t,function(){return this}())},514:function(e,t,n){function Emitter(e){if(e)return mixin(e)}function mixin(e){for(var t in Emitter.prototype)e[t]=Emitter.prototype[t];return e}e.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Emitter.prototype.once=function(e,t){function on(){this.off(e,on),t.apply(this,arguments)}return on.fn=t,this.on(e,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if(r=n[o],r===t||r.fn===t){n.splice(o,1);break}return this},Emitter.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},Emitter.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length}},515:function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},516:function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},517:function(e,t){"use strict";function encode(e){var t="";do t=r[e%o]+t,e=Math.floor(e/o);while(e>0);return t}function decode(e){var t=0;for(a=0;a<e.length;a++)t=t*o+i[e.charAt(a)];return t}function yeast(){var e=encode(+new Date);return e!==n?(s=0,n=e):e+"."+encode(s++)}for(var n,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,i={},s=0,a=0;a<o;a++)i[r[a]]=a;yeast.encode=encode,yeast.decode=decode,e.exports=yeast},518:[808,519],519:[809,520],520:484,521:function(e,t,n){(function(t){function empty(){}function JSONPPolling(e){r.call(this,e),this.query=this.query||{},i||(t.___eio||(t.___eio=[]),i=t.___eio),this.index=i.length;var n=this;i.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=empty)},!1)}var r=n(503),o=n(516);e.exports=JSONPPolling;var i,s=/\n/g,a=/\\n/g;o(JSONPPolling,r),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},JSONPPolling.prototype.doWrite=function(e,t){function complete(){initIframe(),t()}function initIframe(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){r=document.createElement("iframe"),r.name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}this.form.action=this.uri(),initIframe(),e=e.replace(a,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&complete()}:this.iframe.onload=complete}}).call(t,function(){return this}())},522:function(e,t,n){(function(t){function WS(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=h&&!e.forceNode,this.usingBrowserWebSocket||(l=r),o.call(this,e)}var r,o=n(504),i=n(505),s=n(515),a=n(516),c=n(517),p=n(518)("engine.io-client:websocket"),h=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{r=n(523)}catch(e){}var l=h;l||"undefined"!=typeof window||(l=r),e.exports=WS,a(WS,o),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},WS.prototype.write=function(e){function done(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}var n=this;this.writable=!1;for(var r=e.length,o=0,s=r;o<s;o++)!function(e){i.encodePacket(e,n.supportsBinary,function(o){if(!n.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),n.perMessageDeflate){var s="string"==typeof o?t.Buffer.byteLength(o):o.length;s<n.perMessageDeflate.threshold&&(i.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,i)}catch(e){p("websocket closed before onclose event")}--r||done()})}(e[o])},WS.prototype.onClose=function(){o.prototype.onClose.call(this)},WS.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},WS.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e);var r=this.hostname.indexOf(":")!==-1;return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},WS.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===WS.prototype.name)}}).call(t,function(){return this}())},523:function(e,t){},524:function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},525:function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(o,"]").replace(i,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},526:function(e,t,n){function Socket(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var r=n(485),o=n(527),i=n(528),s=n(529),a=n(530),c=n(482)("socket.io-client:socket"),p=n(507);e.exports=t=Socket;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=o.prototype.emit;o(Socket.prototype),Socket.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},Socket.prototype.open=Socket.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},Socket.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},Socket.prototype.emit=function(e){if(h.hasOwnProperty(e))return l.apply(this,arguments),this;var t=i(arguments),n=r.EVENT;p(t)&&(n=r.BINARY_EVENT);var o={type:n,data:t};return o.options={},o.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),delete this.flags,this},Socket.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},Socket.prototype.onopen=function(){c("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:r.CONNECT,query:this.query}):this.packet({type:r.CONNECT}))},Socket.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},Socket.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},Socket.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?l.apply(this,t):this.receiveBuffer.push(t)},Socket.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=i(arguments);c("sending ack %j",o);var s=p(o)?r.BINARY_ACK:r.ACK;t.packet({type:s,id:e,data:o})}}},Socket.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},Socket.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)l.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},Socket.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Socket.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},Socket.prototype.close=Socket.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},Socket.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},527:514,528:function(e,t){function toArray(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}e.exports=toArray},529:function(e,t){function on(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}e.exports=on},530:function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},531:function(e,t){function Backoff(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=Backoff,Backoff.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(e){this.ms=e},Backoff.prototype.setMax=function(e){this.max=e},Backoff.prototype.setJitter=function(e){this.jitter=e}},532:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(181),a=function(){function AnimationService(){this.running=!1,this.general={dt:0,last:0,frame:0}}return AnimationService.prototype.animation=function(){var e=this;return new s.Observable(function(t){e.animate(t)})},AnimationService.prototype.animate=function(e){var t=this,n=(new Date).getTime();this.general.dt=Math.min(1,(n-this.general.last)/1e3),this.general.last=n,this.general.frame++,this.general.frame>24&&(this.general.frame=0),this.running&&e.next(this.general),requestAnimationFrame(function(){return t.animate(e)})},AnimationService.prototype.stopAnimation=function(){this.running=!1},AnimationService.prototype.startAnimation=function(){this.running=!0},AnimationService}();a=r([i.Injectable(),o("design:paramtypes",[])],a),t.AnimationService=a},533:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function PlayerService(){this.texture=n(65),this.bike=n(64)}return PlayerService.prototype.setTexture=function(e){this.texture=e},PlayerService.prototype.getTexture=function(){return this.texture},PlayerService.prototype.setBike=function(e){this.bike=e},PlayerService.prototype.getBike=function(){return this.bike},PlayerService.prototype.setName=function(e){this.name=e},PlayerService.prototype.getName=function(){return this.name},PlayerService}();s=r([i.Injectable(),o("design:paramtypes",[])],s),t.PlayerService=s},534:function(e,t,n){e.exports=n.p+"assets/level_lennart_2.cab7d4088be847c0ce89fea322aae254.obj"},535:function(e,t,n){e.exports=n.p+"assets/tron-02.4643d338df6de72d03d8886edfa74992.jpg"},536:function(e,t){e.exports='<div #canvas class="main">\n    <div class="gui">\n        <progress class="speed-progress" max="400" [value]="gui.speed * 100"></progress>\n        <i class="speed">{{(gui.speed * 100).toFixed(0)}} km/h</i>\n        <i class="gravity">{{(gui.gravity.toFixed(0))}} m</i>\n        <i class="laptime">Current: {{(gui.lapTime)}} sec</i>\n        <i class="best-lap">Best: {{(gui.bestLap)}} sec</i>\n        <div [hidden]="!state.dead">\n\n            <h2 >YOU DIEDEDEDED </h2>\n            <button (click)="reloadGame()">restart</button>\n        </div>\n    </div>\n</div>';
},537:function(e,t){e.exports="<router-outlet></router-outlet>\n<!-- Routed views go here -->\n"},538:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(533),a=n(24),c=function(){function HomeComponent(e,t){this._player=e,this._router=t,this.name=""}return HomeComponent.prototype.selectBike=function(){this._player.setName(this.name),this._router.navigate(["/player"])},HomeComponent}();c=r([i.Component({selector:"home",template:n(539)}),o("design:paramtypes",[s.PlayerService,a.Router])],c),t.HomeComponent=c},539:function(e,t){e.exports='<div>\n    <!--<input type="text" placeholder="name">-->\n    <!--<input type="password" placeholder="password">-->\n    <button (click)="selectBike()">Select bike</button>\n</div>'},540:function(e,t,n){(function(e){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=n(532),a=n(60),c=n(61),p=n(63),h=n(24),l=n(533),u=function(){function PlayerSelectComponent(t,r,o,i,s,a){this._animationService=t,this._lightService=r,this._loader=o,this._skyBoxService=i,this._player=s,this._router=a,this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,1280/720,1,2e5),this.renderer=new e.WebGLRenderer,this.trackingBike=new e.Vector3(0,0,0),this.trackIndex=0,this.t=0,this.loaded={bike01:!1,bike02:!1,bike03:!1,skybox:!1},this.general={dt:0,last:0,frame:0},this.textures=[n(65),n(535),n(541)],this.bikes=[n(64),n(64),n(64)]}return PlayerSelectComponent.prototype.ngOnInit=function(){var e=this;this.loader(),this.animateSubscription=this._animationService.animation().subscribe(function(t){e.general=t,e.render()})},PlayerSelectComponent.prototype.loader=function(){var e=this;this.light=this._lightService.addSoftAmbientLight(),this.pointLight01=this._lightService.createSpotLight(14532543),this.pointLight02=this._lightService.createSpotLight(14532543),this.pointLight03=this._lightService.createSpotLight(14532543),this._loader.loadOBJ(this.bikes[0],this.textures[0]).then(function(t){e.bike01=t,e.handleLoaded("bike01")}),this._loader.loadOBJ(this.bikes[1],this.textures[1]).then(function(t){e.bike02=t,e.handleLoaded("bike02")}),this._loader.loadOBJ(this.bikes[2],this.textures[2]).then(function(t){e.bike03=t,e.handleLoaded("bike03")}),this._skyBoxService.init().then(function(t){t.name="skyBox",e.skyBox=t,e.handleLoaded("skybox")})},PlayerSelectComponent.prototype.handleLoaded=function(e){this.loaded[e]=!0;var t=!0;for(var n in this.loaded)this.loaded[n]||(t=!1);t&&this.setup()},PlayerSelectComponent.prototype.setup=function(){this.camera.position.x=500,this.camera.position.z=500,this.camera.position.y=175,this.skyBox.position.copy(this.camera.position),this.scene.add(this.skyBox),this.initBikes(),this.pointLight01.position.copy(this.bike01.position),this.pointLight02.position.copy(this.bike02.position),this.pointLight03.position.copy(this.bike03.position),this.pointLight01.position.y=3e3,this.pointLight02.position.y=3e3,this.pointLight03.position.y=3e3,this.pointLight01.lookAt(this.bike01.position),this.pointLight02.lookAt(this.bike02.position),this.pointLight03.lookAt(this.bike03.position),this.scene.add(this.pointLight01),this.scene.add(this.pointLight02),this.scene.add(this.pointLight03),this.renderer.setSize(1280,720),this._canvas.nativeElement.appendChild(this.renderer.domElement),this._animationService.startAnimation()},PlayerSelectComponent.prototype.initBikes=function(){this.bike02.position.x=1e3,this.bike02.position.z=1e3,this.bike03.position.x=-1e3,this.bike03.position.z=1e3;var t=new e.CylinderGeometry(300,300,20,64),n=new e.MeshBasicMaterial({color:5000268}),r=new e.Mesh(t,n),o=new e.Mesh(t,n),i=new e.Mesh(t,n);r.position.copy(this.bike01.position),o.position.copy(this.bike02.position),i.position.copy(this.bike03.position),r.position.y=-20,o.position.y=-20,i.position.y=-20,this.scene.add(r),this.scene.add(o),this.scene.add(i),this.scene.add(this.bike01),this.scene.add(this.bike02),this.scene.add(this.bike03)},PlayerSelectComponent.prototype.nextBike=function(){switch(this.trackIndex){case 0:this.trackingBike=this.bike02.position,this.trackIndex=1;break;case 1:this.trackingBike=this.bike03.position,this.trackIndex=2;break;case 2:this.trackingBike=this.bike01.position,this.trackIndex=0}},PlayerSelectComponent.prototype.render=function(){this.t+=.01,this.camera.position.x=500*Math.cos(this.t)+this.trackingBike.x,this.camera.position.z=500*Math.sin(this.t)+this.trackingBike.z,this.camera.lookAt(this.trackingBike),this.renderer.render(this.scene,this.camera)},PlayerSelectComponent.prototype.startRace=function(){this._animationService.stopAnimation(),this._player.setTexture(this.textures[this.trackIndex]),this._player.setBike(this.bikes[this.trackIndex]),this._router.navigate(["/game"])},PlayerSelectComponent}();r([i.ViewChild("canvas"),o("design:type",i.ElementRef)],u.prototype,"_canvas",void 0),u=r([i.Component({selector:"player-select",template:n(542)}),o("design:paramtypes",[s.AnimationService,a.LightService,p.LoaderService,c.SkyBoxService,l.PlayerService,h.Router])],u),t.PlayerSelectComponent=u}).call(t,n(58))},541:function(e,t,n){e.exports=n.p+"assets/tron-03.4759ee4464949b3bd8526597795ab8b0.jpg"},542:function(e,t){e.exports='<div #canvas class="main">\n    <div class="gui">\n        <button (click)="nextBike()" >Next Bike</button>\n        <button (click)="startRace()" >Start Race</button>\n    </div>\n</div>'},543:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=n(3),s=function(){function PageNotFoundComponent(){}return PageNotFoundComponent}();s=r([i.Component({selector:"page-not-found",template:n(544)}),o("design:paramtypes",[])],s),t.PageNotFoundComponent=s},544:function(e,t){e.exports="<div>\n    404\n</div>"},808:function(e,t,n,r){(function(o){function useColors(){return"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function load(){try{return t.storage.debug}catch(e){}if("undefined"!=typeof o&&"env"in o)return{ENV:"production"}.DEBUG}function localstorage(){try{return window.localStorage}catch(e){}}t=e.exports=n(r),t.log=log,t.formatArgs=formatArgs,t.save=save,t.load=load,t.useColors=useColors,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(load())}).call(t,n(421))},809:function(e,t,n,r){function selectColor(){return t.colors[i++%t.colors.length]}function debug(e){function disabled(){}function enabled(){var e=enabled,n=+new Date,r=n-(o||n);e.diff=r,e.prev=o,e.curr=n,o=n,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&(i=["%o"].concat(i));var a=0;i[0]=i[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;a++;var o=t.formatters[r];if("function"==typeof o){var s=i[a];n=o.call(e,s),i.splice(a,1),a--}return n}),i=t.formatArgs.apply(e,i);var c=enabled.log||t.log||console.log.bind(console);c.apply(e,i)}disabled.enabled=!1,enabled.enabled=!0;var n=t.enabled(e)?enabled:disabled;return n.namespace=e,n}function enable(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&(e=n[o].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function disable(){t.enable("")}function enabled(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=debug.debug=debug,t.coerce=coerce,t.disable=disable,t.enable=enable,t.enabled=enabled,t.humanize=n(r),t.names=[],t.skips=[],t.formatters={};var o,i=0}});
//# sourceMappingURL=app.9dd32e088cff11da5244.js.map