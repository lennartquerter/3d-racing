webpackJsonp([0],[function(e,t,n){"use strict";var o=n(1),i=n(23);o.platformBrowserDynamic().bootstrapModule(i.AppModule)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=n(3),s=n(21),a=n(24),p=function(){function AppModule(){}return AppModule}();p=o([r.NgModule({imports:[s.BrowserModule],declarations:[a.AppComponent],bootstrap:[a.AppComponent]}),i("design:paramtypes",[])],p),t.AppModule=p},function(e,t,n){(function(e){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=n(3),s=n(26),a=n(27),p=n(28),c=n(30),d=function(){function AppComponent(t,n,o,i){this._updateService=t,this._lightComponent=n,this._loader=o,this._skyboxComponent=i,this.gui={speed:0},this.loaded={level:!1,user:!1,skybox:!1},this.general={dt:0,last:0},this.keys={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1},this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,1280/720,1,1e5),this.renderer=new e.WebGLRenderer}return AppComponent.prototype.handleKeyDown=function(e){this.onKeyPress(e,!0)},AppComponent.prototype.handleKeyUp=function(e){this.onKeyPress(e,!1)},AppComponent.prototype.onKeyPress=function(e,t){"w"==e.key||38==e.keyCode?this.keys.UP=t:"s"==e.key||40==e.keyCode?this.keys.DOWN=t:"a"==e.key||37==e.keyCode?this.keys.LEFT=t:"d"!=e.key&&39!=e.keyCode||(this.keys.RIGHT=t)},AppComponent.prototype.ngOnInit=function(){var e=this;this.light=this._lightComponent.init(),this.pointLight=this._lightComponent.addPointLight();var t=n(31),o=n(32);this._loader.loadOBJ(t,o).then(function(t){e.player=t,e.handleLoaded("user")});var i=n(33),r=n(34);this._loader.loadOBJ(i,r).then(function(t){e.level=t,e.handleLoaded("level")}),this._skyboxComponent.init().then(function(t){e.skyBox=t,e.handleLoaded("skybox")})},AppComponent.prototype.handleLoaded=function(e){this.loaded[e]=!0;var t=!0;for(var n in this.loaded)this.loaded[n]||(t=!1);t&&this.setup()},AppComponent.prototype.setup=function(){this.setupInitState(),this.addObjectsToScene(),this._canvas.nativeElement.appendChild(this.renderer.domElement),this.animate()},AppComponent.prototype.setupInitState=function(){this.skyBox.position.copy(this.camera.position),this.pointLight.position.copy(this.camera.position),this.renderer.setSize(1280,720)},AppComponent.prototype.addObjectsToScene=function(){this.scene.add(this.player),this.scene.add(this.level),this.scene.add(this.light),this.scene.add(this.pointLight),this.scene.add(this.skyBox)},AppComponent.prototype.animate=function(){var e=this,t=(new Date).getTime();this.general.dt=Math.min(1,(t-this.general.last)/1e3),this.general.last=t,this.render(),requestAnimationFrame(function(){return e.animate()})},AppComponent.prototype.render=function(){this.gui.speed=this._updateService.update(this.player,this.camera,this.keys,this.general.dt),this.skyBox.position.copy(this.player.position),this.renderer.render(this.scene,this.camera)},AppComponent}();o([r.ViewChild("canvas"),i("design:type",r.ElementRef)],d.prototype,"_canvas",void 0),o([r.HostListener("document:keydown",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],d.prototype,"handleKeyDown",null),o([r.HostListener("document:keyup",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],d.prototype,"handleKeyUp",null),d=o([r.Component({selector:"app",template:n(35),providers:[s.UpdateService,a.LightComponent,p.SkyboxComponent,c.LoaderService]}),i("design:paramtypes",[s.UpdateService,a.LightComponent,c.LoaderService,p.SkyboxComponent])],d),t.AppComponent=d}).call(t,n(25))},,function(e,t){"use strict";var n=function(){function UpdateService(){this.acceleration=0,this.generalCarSpeedMultiplier=1e3,this.direction={X:0,Z:0,Y:0}}return UpdateService.prototype.init=function(){},UpdateService.prototype.update=function(e,t,n,o){var i=o*this.generalCarSpeedMultiplier;return this.direction={X:0,Z:0,Y:0},this.acceleration>0?this.acceleration-=.0012:this.acceleration+=.0012,n.UP&&this.acceleration<4&&(this.acceleration<0?(e.rotateX(.004),this.acceleration+=.03):this.acceleration+=.02),n.DOWN&&this.acceleration>-1.4&&(this.acceleration>0?this.acceleration-=.03:this.acceleration-=.015),n.LEFT&&e.rotateY(.02),n.RIGHT&&e.rotateY(-.02),t.quaternion.slerp(e.quaternion,.1),Math.cos(e.rotation.z)>-1?this.direction.Z=i*this.acceleration*Math.cos(e.rotation.y):this.direction.Z=i*this.acceleration*-Math.cos(e.rotation.y),this.direction.X=i*this.acceleration*Math.sin(e.rotation.y),e.position.z-=this.direction.Z,e.position.x-=this.direction.X,e.position.y-=this.direction.Y,t.position.z-=this.direction.Z,t.position.x-=this.direction.X,t.position.y-=this.direction.Y,t.position.y=200,this.acceleration},UpdateService}();t.UpdateService=n},function(e,t,n){(function(e){"use strict";var n=function(){function LightComponent(){this.color=4210752,this.whiteColor=16777215}return LightComponent.prototype.init=function(){return new e.AmbientLight(this.whiteColor,1)},LightComponent.prototype.addPointLight=function(){return new e.DirectionalLight(this.color,1)},LightComponent}();t.LightComponent=n}).call(t,n(25))},function(e,t,n){(function(e){"use strict";var o=function(){function SkyboxComponent(){}return SkyboxComponent.prototype.init=function(){var t=new e.SphereGeometry(1e4,25,25),o=new e.TextureLoader;return new Promise(function(i,r){o.load(n(29),function(n){var o=new e.MeshPhongMaterial({map:n}),r=new e.Mesh(t,o);r.material.side=e.BackSide,i(r)})})},SkyboxComponent}();t.SkyboxComponent=o}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg"},function(e,t,n){(function(e){"use strict";var n=function(){function LoaderService(){}return LoaderService.prototype.loadOBJ=function(t,n){var o=new e.LoadingManager;o.onProgress=function(e,t,n){console.log(e,t,n)};var i=new e.OBJLoader(o),r=(new e.TextureLoader).load(n);return r.wrapS=r.wrapT=e.RepeatWrapping,r.repeat.set(2,2),new Promise(function(n,o){i.load(t,function(t){t.traverse(function(t){t instanceof e.Mesh&&(t.material.map=r)}),n(t)})})},LoaderService}();t.LoaderService=n}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/bike_lennart.9613cd5bf1cf98d990a09a14d63987b4.obj"},function(e,t,n){e.exports=n.p+"assets/tron.587552ce4be37cfd05ac08b4142849dd.png"},function(e,t,n){e.exports=n.p+"assets/level_lennart.f6c5e941514ad165ace7ed2a865e1046.obj"},function(e,t,n){e.exports=n.p+"assets/road.93905e756f18ec7cef67d3cc4f3fabd9.jpg"},function(e,t){e.exports='<div #canvas class="main">\n    <div class="gui">\n        <progress class="speed-progress" max="400" [value]="gui.speed * 100"></progress>\n        <i class="speed">{{(gui.speed * 100).toFixed(0)}} km/h</i>\n    </div>\n</div>'}]);
//# sourceMappingURL=app.547529891fae7c3ef08a.js.map