webpackJsonp([0],[function(e,t,n){"use strict";var o=n(1),i=n(23);o.platformBrowserDynamic().bootstrapModule(i.AppModule)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=n(3),s=n(21),a=n(24),c=function(){function AppModule(){}return AppModule}();c=o([r.NgModule({imports:[s.BrowserModule],declarations:[a.AppComponent],bootstrap:[a.AppComponent]}),i("design:paramtypes",[])],c),t.AppModule=c},function(e,t,n){(function(e){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=n(3),s=n(26),a=n(27),c=n(28),p=n(30),h=function(){function AppComponent(t,n,o,i){this._updateService=t,this._lightComponent=n,this._loader=o,this._skyboxComponent=i,this.gui={speed:0},this.general={dt:0,last:0},this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(75,1280/720,1,1e5),this.renderer=new e.WebGLRenderer,this.keys={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1}}return AppComponent.prototype.handleKeyDown=function(e){this.onKeyPress(e,!0)},AppComponent.prototype.handleKeyUp=function(e){this.onKeyPress(e,!1)},AppComponent.prototype.ngOnInit=function(){var e=this,t=n(32);this._loader.loadOBJ(t).then(function(t){return e.car=t});var o=n(33);this._loader.loadOBJ(o).then(function(t){return e.level=t}),this.light=this._lightComponent.init(),this.pointLight=this._lightComponent.addPointLight(),this._skyboxComponent.init().then(function(t){return e.skyBox=t}),setTimeout(function(){return e.start()},2e3)},AppComponent.prototype.start=function(){var e=this;this.camera.position.z=800,this.camera.position.y=200,this.skyBox.position.copy(this.camera.position),this.pointLight.position.copy(this.camera.position),this.scene.add(this.car),this.scene.add(this.level),this.scene.add(this.light),this.scene.add(this.pointLight),this.scene.add(this.skyBox),this.renderer.setSize(1280,720),this._canvas.nativeElement.appendChild(this.renderer.domElement),console.log(this.car),console.log(this.camera),setTimeout(function(){return e.animate()},1e3)},AppComponent.prototype.mouseMovement=function(e){},AppComponent.prototype.onKeyPress=function(e,t){"w"==e.key||38==e.keyCode?this.keys.UP=t:"s"==e.key||40==e.keyCode?this.keys.DOWN=t:"a"==e.key||37==e.keyCode?this.keys.LEFT=t:"d"!=e.key&&39!=e.keyCode||(this.keys.RIGHT=t)},AppComponent.prototype.animate=function(){var e=this,t=(new Date).getTime();this.general.dt=Math.min(1,(t-this.general.last)/1e3),this.general.last=t,this.draw(),requestAnimationFrame(function(){return e.animate()})},AppComponent.prototype.draw=function(){this.gui.speed=this._updateService.update(this.car,this.camera,this.keys,this.general.dt),this.skyBox.position.copy(this.car.position),this.renderer.render(this.scene,this.camera)},AppComponent}();o([r.ViewChild("canvas"),i("design:type",r.ElementRef)],h.prototype,"_canvas",void 0),o([r.HostListener("document:keydown",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],h.prototype,"handleKeyDown",null),o([r.HostListener("document:keyup",["$event"]),i("design:type",Function),i("design:paramtypes",[KeyboardEvent]),i("design:returntype",void 0)],h.prototype,"handleKeyUp",null),h=o([r.Component({selector:"app",template:n(34),providers:[s.UpdateService,a.LightComponent,c.SkyboxComponent,p.LoaderService]}),i("design:paramtypes",[s.UpdateService,a.LightComponent,p.LoaderService,c.SkyboxComponent])],h),t.AppComponent=h}).call(t,n(25))},,function(e,t){"use strict";var n=function(){function UpdateService(){this.acceleration=0,this.generalCarSpeedMultiplier=1e3,this.direction={X:0,Z:0,Y:0}}return UpdateService.prototype.init=function(){},UpdateService.prototype.update=function(e,t,n,o){var i=(e.rotation.y,o*this.generalCarSpeedMultiplier);this.direction={X:0,Z:0,Y:0},this.acceleration>0?this.acceleration-=.0012:this.acceleration+=.0012,n.UP&&this.acceleration<4&&(this.acceleration<0?(e.rotateX(.001),this.acceleration+=.03):this.acceleration+=.02),n.DOWN&&this.acceleration>-1.4&&(this.acceleration>0?this.acceleration-=.03:this.acceleration-=.015);var r=e.position,s=(e.rotation,t.position),a=(r.x-s.x,r.z-s.z);return console.log("x"),console.log(r.x-s.x),console.log("z"),console.log(r.z-s.z),n.LEFT&&(e.rotateY(.01),a<-800&&(t.position.z-=7),t.position.x+=7),n.RIGHT&&(e.rotateY(-.01),a<-800&&(t.position.z-=7),t.position.x-=7),this.direction.Z=i*this.acceleration*Math.cos(e.rotation.y),this.direction.X=i*this.acceleration*Math.sin(e.rotation.y),t.lookAt(e.position),e.position.z-=this.direction.Z,e.position.x-=this.direction.X,e.position.y-=this.direction.Y,t.position.z-=this.direction.Z,t.position.x-=this.direction.X,t.position.y-=this.direction.Y,this.acceleration},UpdateService}();t.UpdateService=n},function(e,t,n){(function(e){"use strict";var n=function(){function LightComponent(){this.color=4210752,this.whiteColor=16777215}return LightComponent.prototype.init=function(){return new e.AmbientLight(this.whiteColor,1)},LightComponent.prototype.addPointLight=function(){return new e.DirectionalLight(this.color,1)},LightComponent}();t.LightComponent=n}).call(t,n(25))},function(e,t,n){(function(e){"use strict";var o=function(){function SkyboxComponent(){}return SkyboxComponent.prototype.init=function(){var t=new e.SphereGeometry(1e4,25,25),o=new e.TextureLoader;return new Promise(function(i,r){o.load(n(29),function(n){var o=new e.MeshPhongMaterial({map:n}),r=new e.Mesh(t,o);r.material.side=e.BackSide,i(r)})})},SkyboxComponent}();t.SkyboxComponent=o}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/skySphere_2.66ae058ccbfea529122c6bdf47620ac5.jpg"},function(e,t,n){(function(e){"use strict";var o=function(){function LoaderService(){}return LoaderService.prototype.loadOBJ=function(t){var o=new e.LoadingManager;o.onProgress=function(e,t,n){console.log(e,t,n)};var i=new e.OBJLoader(o),r=(new e.TextureLoader).load(n(31));return new Promise(function(n,o){i.load(t,function(t){t.traverse(function(t){t instanceof e.Mesh&&(t.material.map=r)}),n(t)})})},LoaderService}();t.LoaderService=o}).call(t,n(25))},function(e,t,n){e.exports=n.p+"assets/grey.22613f9b2b9c3ae9c50baaa11bd38461.png"},function(e,t,n){e.exports=n.p+"assets/bike_lennart.9613cd5bf1cf98d990a09a14d63987b4.obj"},function(e,t,n){e.exports=n.p+"assets/level_lennart.f6c5e941514ad165ace7ed2a865e1046.obj"},function(e,t){e.exports='<div #canvas class="main" (mousemove)="mouseMovement($event)" (keydown)="onKeyDown($event)">\n    <div class="gui">\n        <progress class="speed-progress" max="400" [value]="gui.speed * 100"></progress>\n        <i class="speed">{{(gui.speed * 100).toFixed(0)}} km/h</i>\n    </div>\n</div>'}]);
//# sourceMappingURL=app.0369ac68eba1433ed476.js.map